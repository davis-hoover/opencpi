\iffalse
This file is protected by Copyright. Please refer to the COPYRIGHT file
distributed with this source distribution.

This file is part of OpenCPI <http://www.opencpi.org>

OpenCPI is free software: you can redistribute it and/or modify it under the
terms of the GNU Lesser General Public License as published by the Free Software
Foundation, either version 3 of the License, or (at your option) any later
version.

OpenCPI is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License along
with this program. If not, see <http://www.gnu.org/licenses/>.
\fi

%----------------------------------------------------------------------------------------
% Required document specific properties
%----------------------------------------------------------------------------------------
\def\docTitle{Release Notes}
\def\snippetpath{snippets}
%----------------------------------------------------------------------------------------
% Global latex header (this must be after document specific properties)
%----------------------------------------------------------------------------------------
\input{\snippetpath/LaTeX_Header}
\newcommand{\bugref}[1]{\nameref*{bug:#1} (cf.~\ref{bug:#1})}
\newcommand{\forceindent}{\leavevmode{\parindent=1em\indent}}
\newcommand{\ocpidev}{\code{ocpidev} }
\setlength{\parindent}{0pt}  % Don't indent all paragraphs
%----------------------------------------------------------------------------------------
% This command will make diffs look better in the future...
%----------------------------------------------------------------------------------------
\newcommand{\beginoldnotes}{
% Demote sectional commands from here on out - https://tex.stackexchange.com/a/61803
% This lets us just move the text from above and add a new "origsection" header
\let\origsection\section%
\let\section\subsection%
\let\subsection\subsubsection%
\let\subsubsection\paragraph%
\let\paragraph\subparagraph%
% Make section numbers (Roman)-(Roman).(Arabic) instead of previously defined (Roman)-(Arabic).(Arabic), e.g. old release's II-3 becomes B-II.3 not B-2.3
\renewcommand\thesection{\Roman{section}}
\renewcommand\thesubsection{\thesection-\Roman{subsection}}
\newpage
\begin{appendices}
\label{old_releases}
The Release Notes from previous releases are included here as reference for still-existing bugs, relevant upgrading notes for users of very old versions, etc.
}
% end of beginoldnotes
%----------------------------------------------------------------------------------------

\begin{document}
\maketitle
\thispagestyle{empty}
\newpage

\pagenumbering{roman}
\begin{center}
	\textit{\textbf{Revision History}}
	\begin{table}[H]
		\label{table:revisions} % Add "[H]" to force placement of table
		\begin{tabularx}{\textwidth}{|c|X|l|}
			\hline
			\rowcolor{blue}
			\textbf{Revision} & \textbf{Description of Change} & \textbf{Date} \\
		    \hline
			v1.0.1 & Initial creation & 05/2016 \\
			\hline
			v1.1.0 & Updates for 1.1 release & 03/2017 \\
			\hline
			v1.2.0 & Updates for 1.2 release & 08/2017 \\
			\hline
			v1.3.0 & Updates for 1.3 release & 01/2018 \\
			\hline
			v1.3.1 & Updates for 1.3.1 release & 03/2018 \\
			\hline
			v1.4.0 & Updates for 1.4.0 release and moved previous to appendices & 10/2018 \\
			\hline
			v1.5.0 & Updates for 1.5.0 release & 04/2019 \\
			\hline
			v1.6.0 & Updates for 1.6.0 release & 01/2020 \\
			\hline
			v1.7.0 & Updates for 1.7.0 release & 06/2020 \\
			\hline
			v2.0.0 & Updates for 2.0.0 release & 10/2020 \\
			\hline
			v2.1.0 & Updates for 2.1.0 release & 03/2021 \\
			\hline
			v2.2.0 & Updates for 2.2.0 release & 07/2021 \\
			\hline
			v2.3.0 & Updates for 2.3.0 release & 09/2021 \\
			\hline
			v2.4.0 & Updates for 2.4.0 release & 10/2021 \\
			\hline
		\end{tabularx}
	\end{table}
\end{center}
\newpage

\tableofcontents
% Make section numbers (Roman)-(Arabic).(Arabic) instead of default (Arabic).(Arabic).(Arabic)
\renewcommand\thesection{\Roman{section}}
\renewcommand\thesubsection{\thesection-\arabic{subsection}}
\newpage
\pagenumbering{arabic}
\section*{Overview}
This document contains corrections, changes, and enhancements made to OpenCPI since the previous release. It can never encapsulate \textit{every} change or bug fix, but attempts to assist previous users in getting up and running as swiftly as possible. The \textit{general} format of this document is to answer user questions:
\begin{itemize}
\item Section~I (``Enhancements'') describes ``\textit{What's New?}'' about the current release.
\item Section~II (``Changes and Notes'') is ``\textit{What do I need to be aware of as a \textbf{previous} user of the Framework?}''
\item Section~III (``Major Known Deficiencies'') is for \textit{all} users to answer ``\textit{What bugs should I be aware of?}''
\end{itemize}
The Appendices (beginning on page \pageref{old_releases}) contain the Release Notes from previously released versions of the Framework, roughly following the same format, e.g. \ref{sec:13_enhancements}, being Section~I of the v1.3~Appendix, is the ``Enhancements'' that were added to Release 1.3.

\iffalse
%\origsection{Release XXX}
%\def\ocpiversion{vXXX}  % Need to redefine so doc links are correct
\section{Enhancements}
\section{Changes and Notes}
\section{Major Known Deficiencies}
\label{sec:XX_bugs}
\subsection{Previously Documented Deficiencies}
% === End of XXX
\fi

%\origsection{Release XXX}
\def\ocpiversion{latest}  % Need to redefine so doc links are correct
\section{Enhancements}

\subsection{Training Improvements}
\label{sec:24_training}
This release provides updates to Tutorials 1 through 4 to demonstrate the use of the OpenCPI GUI and to bring the tutorials up to OpenCPI ``best practices''. This release also adds several new tutorials, both ``software only'' (running on the xsim simulator) and ``hardware'' (running on the plutosdr platform).  The OpenCPI briefings have also been updated to OpenCPI best practices and two additional briefings have been added (one for an overview of the Application Control Interface, and one to introduce tools and techniques for debugging).\\

\subsection{Instructional Video Links Added}
\label{sec:24_video_links}
Links to instructional OpenCPI videos on YouTube have been added to opencpi.gitlab.io web page.\\

\subsection{Air-gapped Installation Section Added}
\label{sec:24_air-gap_install}
The OpenCPI Installation Guide provides instructions for performing an air-gapped installation.\\

\subsection{New \code{triggered\_sampler} Components}
\label{sec:24_sdr_triggered_sampler}
Adds new \code{triggered\_sampler} components allowing for applications to gate a settable number samples upon a trigger event, which can be either a write to a property, input data on the optional input port, or a metadata message on the primary input. The following protocols are supported: bool, char, float, long, short, uchar, ulong, ushort, complex char, and complex short.\\

\section{Changes and Notes}

\subsection{\code{complex\_mixer} Component Moved}
\label{sec:24_complex_mixer_moved}
Applications in the tutorial project now utilize the \code{complex\_mixer} component in ``\code{opencpi/projects/assets/components/dsp\_comps}''.\\

\subsection{Updates to Runtime C++ Files}
\label{sec:24_runtime_c++}
Geared towards developers moreso than users, there have been updates made to the c++ runtime code base. The focus of these changes is reorganization for the sake of consistency in file and namespace naming conventions. \\

\subsection{GUI Changes}
\label{sec:24_ie_gui}
The following changes have been made to the new GUI since the previous release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item The user now has the ability to run a single test case when running unit tests.
\item When using ocpiadmin install users are now able to specify the minimal install.
\item The user now has the ability to run the install script for the GUI and it will create an ocpigui command for the user to use to launch the GUI.
\item With the \code{ocpigui} command, users can now use \code{--project-path} to specify the project path for the project explorer to use and
\code{--ocpi-path} to specify the path to the built opencpi project.
\end{itemize}

\section{Major Known Deficiencies}
\label{sec:24_bugs}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 2.4:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

% === End of 2.4.0

\beginoldnotes
\origsection{Release 2.3.0}
\def\ocpiversion{v2.3.0}
\section{Enhancements}

\subsection{PicoEVB HDL Platform}
\label{sec:23_picoevb}
This release adds preliminary (as in ``\textbf{beta}'' -- as in ``\textbf{not everything works}'') support for the ``\code{PicoEVB}'' HDL platform, which is a PCIe-based FPGA device.  Significantly, this is the first PCI device that OpenCPI has supported in many years, and it is the first to use the modern dataplane infrastructure (SDP) with PCI Express.  It can be used as an example for supporting future PCIe-based FPGA platforms.\\

The ``\code{PicoEVB}'' is a low-cost FPGA device from RHS Research\textsuperscript{\texttrademark}.  The board is designed around the Xilinx Artix 7 (XC7A50T) FPGA with a PCIe x1 interface.  The ``\code{PicoEVB}'' will work in the following slots:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item M.2 2230 Key A
\item M.2 2230 Key E
\item M.2 2280 Key M
\item Full length mini PCIe (with carrier board)
\item PCIe x1, x4, x8, or x16 slot (with carrier board)
\end{itemize}
More information about the ``\code{PicoEVB}'' platform can be found at the RHS Research website (\url{https://rhsresearch.com/}).  Note the OpenCPI HDL (FPGA) platform for the ``\code{PicoEVB}'' is called ``\code{picoevb}''.  Additional details may be found in the ``\code{PicoEVB Getting Started Guide}''.\\

The following list highlights the features included with support of the ``\code{PicoEVB}'':
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item Updated interface for PCIe-based Control and Data Planes with SDP support (replaces uNOC implementation)
\item Added method for automatic generation of Xilinx PCIe IP as part of the build process
\item Added assembly for testing HDL platforms without embedded processors
\end{itemize}

\subsection{\code{test\_internal\_assy} Assembly}
\label{sec:23_tia_assy}
The new \code{test\_internal\_assy} assembly is an example of an HDL assembly that generates and receives data internally.  It may be used for testing and validating new HDL platforms.

\subsection{New \code{analog} OSP}
\label{sec:23_analog}
The new ``\code{analog}'' OSP provides OpenCPI support for Analog Devices, Inc. products.  This release provides initial OpenCPI support of \code{ADRV9361-Z7035} attached to \code{ADRV1CRR-BOB}.  

\subsection{New \code{sdr} COMP}
\label{sec:23_sdr}
This is the initial OpenCPI release of the contributed ``\code{ocpi.comp.sdr}'' project (used to be known as ``\code{ocpi.sdr}'').\\

In the months since the project was originally created/contributed, the following enhancements, bugfixes, and features have been added and are present in this release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item Golay Encoder and Decoder components have been added that can be used for forward error correction.
\item Convolutional interleaver and convolutional de-interleaver components have been added which can be used to reduce burst errors when transmitting bursts of data.
\item The deprecated readable attribute has been removed from the value property for the \code{equal\_to\_ul\_b} component.
\item A limit on the number of messages used at the verification stage of unit testing for generator components has been implemented by truncating the generated output files such that they contain no more than a set number of messages.
\item The \code{cic\_interpolator\_xs} HDL worker has been modified to allow for the \code{up\_sample\_factor} property to be set during run time without the worker entering a broken state.
\item All primitives and components have been updated to protocol version 2.
\item Added more support and standardized the testing for components with multiple output ports.
\item Improved the HDL resource efficiency of \code{fir\_filter\_scaled\_xs} and \code{fir\_filter\_scaled\_s} by using the \code{number\_of\_taps} property to set the array length of taps at build time.
\item Improved the HDL resource efficiency of \code{symbol\_mapper\_uc\_l} by using the \code{array\_size} property to set the array length of symbols (previously named values) at build time.
\item Improved performance of RCC worker \code{counter\_up\_down\_b\_uc} (previously \code{counter\_b\_uc}) by updating the volatile property \code{counter\_value} (previously \code{count}) after processing each message instead of each sample in the RCC worker.
\item Added checking of description tag text for both child elements and attributes in xml files to \code{ocpi\_linter}.
\item Renamed the project package name from \code{sdr} to \code{comp.sdr} and updated all \code{example\_app.xml} files accordingly.
\item Renamed \code{counter\_b\_uc} to \code{counter\_up\_down\_b\_uc}.
\item Modified HDL opcode and standard logic vector conversion functions to use \code{'pos} and \code{'val} attributes instead of case statements.
\item Modified all HDL worker signal names to lowercase.
\item Added \code{bias\_xs} component with RCC and HDL workers.
\item Added \code{carrier\_generator\_s} component with RCC and HDL workers.
\item Added \code{cic\_decimator\_xs} RCC worker.
\item Added \code{constant\_l} component with RCC and HDL workers.
\item Added \code{constant\_ul} component with RCC and HDL workers.
\item Added \code{counter\_up\_down\_b\_ul} component with RCC and HDL workers.
\item Added \code{counter\_up\_resettable\_b\_ul} component with RCC and HDL workers.
\item Added \code{fir\_filter\_scaled\_s} RCC worker.
\item Added \code{fir\_filter\_scaled\_xs} RCC worker.
\item Added \code{multiplexer\_l} component with RCC and HDL workers.
\item Added \code{multiplexer\_ul} component with RCC and HDL workers.
\item Added \code{ramp\_generator\_l} component with RCC and HDL workers.
\item Added \code{register\_b} component with RCC and HDL workers.
\item Added \code{register\_l} component with HDL worker.
\item Added \code{register\_ul} component with HDL worker.
\end{itemize}

\subsection{\code{capture\_v2} Unit Test}
\label{sec:23_capture_v2}
A new script has been created that generates an output file for the \code{capture\_v2} unit test's properties in a more readable format.  The input to the script is a property dump file when using the \code{dumpFile} option when running an app, or a \code{.log} file generated by a unit test. It is located in ``\code{opencpi/projects/assets/scripts/format\_capture\_v2\_property\_dump.py}''.

\section{Changes and Notes}

\subsection{\code{ocpidev}}
\label{sec:23_ocpidev}
The ``\code{-t}'' option is no longer available.  Test assets cannot be created simultaneously with component assets.

\subsection{\code{ocpidoc}}
\label{sec:23_ocpidoc}
Although a great deal of progress has been made on finalizing the new documentation generator for OpenCPI assets, it should still be considered as ``preliminary'' in this release.

\subsection{GUI Changes}
\label{sec:23_ie_gui}
The following changes have been made to the new GUI since the previous release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item When building OpenCPI assets or running unit tests, RCC and HDL targets can now have multiple platforms selected for a single operation.
\item The GUI's ``\code{right click}'' menu is now context sensitive with respect to the OpenCPI asset being clicked on, and will only show options/operations relevant to that asset.
\end{itemize}

\section{Major Known Deficiencies}
\label{sec:23_bugs}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 2.3:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

% === End of 2.3.0

\origsection{Release 2.2.0}
\def\ocpiversion{v2.2.0}
\section{Enhancements}

\subsection{Xilinx Vivado 2020.2 Support}
\label{sec:22_vivado}
Xilinx Vivado 2020.2 is supported as of this release on all OpenCPI development platforms.

\subsection{Ubuntu 20.04}
\label{sec:22_ubuntu20}
Ubuntu 20.04 is now a supported OpenCPI development platform.  N.B.: The minimum Xilinx tool version that will work with this platform is 2020.2.\\

With the introduction of ``\code{ubuntu20\_04}'' as a supported OpenCPI development platform, the ``\code{ubuntu16\_04}'' platform is officially deprecated as of this release.  Ubuntu 16.04 is no longer supported by Canonical (no updates available), but we will continue to support OpenCPI on Ubuntu 16.04 until the next major release (3.0.0).

\subsection{``\code{makeless}'' Development}
\label{sec:22_makeless}
Over the last year or so we have been moving toward making OpenCPI ``makeless''.  ``Makeless'' means we have been slowly removing ``make'' and ``make files'' from the developer experience while allowing previous Makefiles and make commands to continue working.\\

The motivation for this is twofold:\\

\begin{itemize}
\setlength\itemsep{0em} %tighten
\item Reduce learning required of users (no need to know about ``make'') in particular consideration of the error-prone nature of make where spelling errors in variable names are not flagged.  Basically it is too easy to make mistakes, hard to help users when they make them, and ``make'' represents an added learning burden to use OpenCPI.
\item Enable us to modernize and optimize the OpenCPI ``build engine'', with the freedom to move the inner machinery away from using ``make'' without impacting users.  There are major opportunities to improve the efficiency and parallelism of the build process that are easier to exploit if we are not tied to the ``make'' infrastructure.  While some of these optimizations are possible in the ``make'' environment, they are brittle and hard to maintain, and require advanced knowledge of ``make'' that is hard to find.
\end{itemize}

This has been accomplished by moving what was previously variable settings in Makefiles into additional top-level attributes in XML files.  In most cases there was already an XML file in the relevant directory so this eliminated the Makefile, and added attributes to the XML file.\\

So where there are already XML files for assets (workers, tests, assemblies, applications, platforms), there is a migration of Makefile variable settings into top-level attributes of the existing XML files.  All documented ``make'' variable settings are now XML attributes.\\

Where there were \textit{only} Makefiles, they have been replaced with XML files, with attributes corresponding to the previously documented Makefile variable settings.\\

So for all directories where there were previously only Makefiles, there are now XML files.  Also, all *.mk files in projects are superceded by the contents of the XML files.\\

The names of the XML files are the name of the directory minus any suffix.  The exceptions to this simple rule are:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item test directories have \textless name\textgreater -test.xml as they always did.
\item project directories have Project.xml files, and no Project.mk or Makefiles
\end{itemize}

New XML files are for these asset types:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item projects
\item HDL primitives
\item component libraries
\end{itemize}

New XML files also replace Makefiles in the "plural" directories:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item components (when there are libraries under components/)
\item hdl/primitives
\item hdl/platforms
\item applications
\end{itemize}

One asset type still has a Makefile and a \textless platform\textgreater .mk file: RCC platforms.\\

The builtin projects of OpenCPI are now a mix of ``makeless'', to test the new scheme, and ``legacy'' to ensure that old Makefiles still work.\\

In the 3.0 release, support for all the Makefiles may be removed.\\

There are a number of cases where Makefiles are still required to do complex things, but in the future we may use a different approach to ``customizing the build process'' and remove ``make'' entirely.


\subsection{Inferred Project Dependencies}
\label{sec:22_project_deps}
A project with hdl assemblies can now be built for a target platform without knowing the project dependencies of the project where the target platform lives.  This was always the intent, but was not previously enabled/implemented.

\subsection{``On Demand'' Worker Configuration/Building}
\label{sec:22_on_demand}
When building HDL assemblies, containers, and platform configurations, workers (and parameter configurations of workers) can be built on demand, as needed at the time the assemblies (of the three types) are built.  Building HDL primitives and HDL platforms is still a prerequisite to building these assemblies.  At installation time, a ``\code{--minimal}'' option can be supplied to ``\code{ocpiadmin install platform}'' which will only build the minimum: primitives and platforms.  Then, when building assemblies or platform configurations or even unit tests, a ``\code{--workers-as-needed}'' option can be supplied to the ``\code{ocpidev build}'' command to automatically built the required workers of the required configurations.  Note that a worker configuration does not have to be predefined to be built.  The worker configurations in ``*-build.xml'' files are primarily required to define what will be unit tested.

\subsection{Multiple Device Instances}
\label{sec:22_device_inst}
This release contains new support for platform developers with platforms that have multiple instances of the same device, and enables applications and slave assemblies to specify the exact device when instantiating a device worker.

\subsection{\code{zcu104} Regression Fixed}
\label{sec:22_zcu104}
The \code{zcu104} regression in v2.1.0 and v2.1.1 that required the workaround of setting \code{OCPI\_DMA\_CACHE\_MODE} to zero on the embedded system has been fixed, i.e., as of this release, the workaround is no longer necessary.

\subsection{New Documentation Generator}
\label{sec:22_ocpidoc}
This release marks the initial announcement of the new \code{ocpidoc} tool.\\

\code{ocpidoc} is a documentation generator for OpenCPI assets.  Writing documentation for OpenCPI assets (e.g., components) can be burdensome, with common information required in some cases. To reduce this burden, a standard way of writing asset documentation is included so that:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item the required information is captured; and
\item for parts that can be automatically documented, information is included from, e.g., OpenCPI component specification XML files.
\end{itemize}

Note this is a preliminary implementation of the document generation capability which will be finalized in the upcoming v2.3.0 release.  Also, the use of the \code{ocpidoc} tool will be changed so that, when necessary, it runs underneath \code{ocpidev} and will not be directly invoked by users.\\

The \code{Sphinx} doc tools version required by \code{ocpidoc} is more recent than provided in the package repositories of any current OpenCPI-supported development platform.  This dependency is handled in a distro-independent manner that is sandboxed from, and mostly invisible to, users.

\subsection{\code{RCCResult} Return Values}
\label{sec:22_rcc_values}
The new-in-this-release \code{RCCResult} return values \code{RCC\_FINISHED} and \code{RCC\_ADVANCE\_FINISHED} will replace \code{RCC\_DONE} and \code{RCC\_ADVANCE\_DONE} in the next major release (3.0.0), i.e., \code{RCC\_DONE} and \code{RCC\_ADVANCE\_DONE} are deprecated as of this release.

\subsection{ettus OSP}
\label{sec:22_ettus}
The \code{ettus} platform project (opencpi/osp/ocpi.osp.ettus) is new in this release, and provides preliminary support for the Ettus N310 v4.0.0 RCC platform.

\subsection{New GUI Beta}
\label{sec:22_ie_gui}
A preliminary version of a new GUI for OpenCPI development is officially available as of this release.  The associated project is \code{opencpi/ie-gui}.  Feedback is definitely encouraged.

\subsection{RCC Proxy Workers}
\label{sec:22_proxy_workers}
RCC proxy workers can now have HDL platforms as explicit slaves in case the proxy needs to have access to aspects of the HDL platform.

\subsection{\code{zcu106} Platform Support}
\label{sec:22_zcu106}
This release contains preliminary support for the \code{zcu106} (Zynq Ultrascale ZCU106 Xilinx Development Board) platform.

\subsection{\code{complex\_short\_time\_sample} (CSTS) Workers/Apps}
\label{sec:22_csts}
Initial support for new CSTS workers and applications is present in this release.  Eventually, new CSTS versions of ``ComplexShortWithMetadata'' (CSWM) workers and applications will be available.  As they become available, using them is as simple as specifying ``\_csts'' in the names of the workers/applications -- they will use the new protocol automatically. Otherwise identical names without ``\_csts'' are the CSWM versions.\\

In some future release, there will be a switch to use CSTS by default, meaning the CSWM worker versions will be moved to the ``inactive'' project and a ``\_cswm'' naming convention added.  At the same time, the ``\_csts'' naming convention will be removed, i.e., the CSTS versions will be the default.\\

At present, it is intended the CSWM versions of workers will continue to be available for use, but the CSWM versions of applications may not. 

\section{Changes and Notes}

\subsection{\code{ocpidev}}
\label{sec:22_ocpidev}
The \code{ocpidev} program is in the process of being completely rewritten in Python (for reasons of maintainability), and the rewrite is mostly complete with this release. The associated changes are intended to be transparent to the user, i.e., no changes in functionality or usage due to the rewrite.\\

With respect to other \code{ocpidev} changes affecting the unit test CLI, note the following:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item ``\code{ocpidev build}'' is used for generating and building.
\item ``\code{ocpidev run}'' is used for executing and verifying.
\item The ``mode'' stuff is gone, and ``\code{ocpidev run}'' does not build tests anymore.
\end{itemize}

\subsection{Decoupling of OCPI\_CDK\_DIR and OCPI\_ROOT\_DIR Environment Variables}
\label{sec:22_cdk_rootdir}
The location of the ``root'' and ``cdk'' directories depends on the installation and mode.  Previously, \code{OCPI\_CDK\_DIR} had to be a direct sub-directory of \code{OCPI\_ROOT\_DIR}.  Effective with this release, \code{OCPI\_CDK\_DIR} and \code{OCPI\_ROOT\_DIR} have been decoupled, and deviations from the ``normal/usual'' directory structure only require changing one line in the relevant setup script.

\subsection{\code{data\_sink\_qdac} and \code{data\_src\_qdac} Workers}
\label{sec:22_worker_updates}
The platform HDL device workers \code{data\_sink\_qdac} and \code{data\_src\_qdac} previously used the ``\code{ComplexShortWithMetadata}'' protocol.  They now use the ``\code{complex\_short\_timed\_sample}'' protocol.

\subsection{Python ACI Update}
\label{sec:22_aci}
The annoying need to prefix strings with ``b'' to force treatment of same as bytes objects (vs. Unicode str objects -- the Python 3 default) has been eliminated.

\section{Major Known Deficiencies}
\label{sec:22_bugs}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 2.2:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

% === End of 2.2.0

\origsection{Release 2.1.0}
\def\ocpiversion{v2.1.0}
\section{Enhancements}

\subsection{GNU Radio Installation Support}
\label{sec:21_gnuradio_install}
A new convenience script, \code{scripts/install-gnuradio.sh}, is available to install OpenCPI's modified version of GNU Radio 3.7 and GNU Radio Companion.  Supported host operating systems are CentOS 7 and Ubuntu 18.04.

\subsection{ADI \code{mykonos} Library}
\label{sec:21_mykonos_library}
For those writing device workers (proxies) for the ad9371 (a.k.a. mykonos), the \code{mykonos} library has been added as a prerequisite library.

\subsection{FSK Application on Matchstiq Z1}
\label{sec:21_fsk_application}
The matchstiq z1's lime device workers are now able to run in baseband loopback mode for the FSK application.

\subsection{\code{ComplexShortWithMetadata-prot.xml} Sequence Length}
\label{sec:21_seq_length}
\code{ComplexShortWithMetadata-prot.xml} has been updated to use a sequence length of 4096 instead of 4092 for the ``iq'' argument of the samples operation.  Workers or primitives assuming a sequence length of 4092 should be updated to use 4096 instead.

\subsection{Digital Radio Controller}
\label{sec:21_drc}
The new Digital Radio Controller (DRC) component is used when an application needs to use radio hardware in the system, for the purpose of controlling it and streaming sample data to and from it.  The “digital radio” functionality in a system usually has antennas for transmitting and receiving RF signals, and channels which convert the RF signals to and from base-band digital samples that are produced and consumed by the application.\\

See the ``\code{OpenCPI Application Development Guide}'', the ``\code{OpenCPI Platform Development Guide}'', and the new ``\code{Digital Radio Controller}'' briefing for more information.

\subsection{Proxy Workers and Slaves Model}
\label{sec:21_infer_slaves}
An enhanced model of proxy workers and slaves has been implemented which renders previous methods obsolete and deprecated.  The new model is that a proxy worker's slaves are automatically included in the application when that worker is chosen for some component instance in the application.  A worker author specifies the slaves of a proxy in the form of a subassembly, which can have instance properties and connections.  External ports of the subassembly are associated with ports of the proxy such that application connections to the proxy's ports may be delegated to the external ports of the slave subassembly.
In this way, the application does not care about the slaves and does not mention the slaves.  This allows applications to be more portable since they do not need to know about slaves at all.  This is particularly useful for the newly released DRC component specification used for controlling radios, since different DRCs use different slaves.\\

Workers in the slave assemblies (as well as HDL assemblies and the optional "worker" attribute of app instances) may now use fully qualified package-ids.

\subsection{Proxy Worker Capabilities}
\label{sec:21_proxy_capabilities}
As part of a package of enhancements for the capabilities of proxy workers,
delegated ports have been upgraded to support delegating a proxy port that
has a count (that is an array of ports) such that the underlying slave
assembly can connect to the individual ports in the proxy's delegated array
ports.  The immediate use-case is when DRC proxies support multichannel
radios and thus have RX and TX ports that are arrays of ports for supporting
the multiple DRC channels.

\subsection{Scalable Software-side Buffer Count Without Memory Bloat}
\label{sec:21_sdp_width}
The Scalable Data Plane (SDP) is now 64 bits wide on zynq platforms.\\

The CPU-side number of DMA buffers on HDL--\textgreater RCC connections can now be large -- up to 255.\\

The amount of DMA memory allocated can now be specified as an option to the \code{ocpidriver} and \code{ocpiremote} commands.\\

A simple \code{test\_source} component, and associated RCC and HDL workers, have been added and are useful for performance testing.\\

The \code{file\_write} (RCC) worker now reports bytes/second and has a data integrity checking option when writing what is generated by the \code{test\_source} component, as well as an option to suppress writing the data at all.

\subsection{Timed Transmission}
\label{sec:21_timed_xmit}
A time gating HDL worker has been added to support timed transmission.
It allows samples to flow through until it receives a time opcode and
timestamp for a scheduled time to transmit. When it receives the time
opcode and timestamp it will stop samples from flowing through until
the scheduled time to transmit and then it will let samples flow through
again. It also allows setting a time correction, that is an unsigned
fixed point fraction of second, which is subtracted from the scheduled
time to open the gate early so that samples flow at the right time.

\subsection{Performance Improvements}
\label{sec:21_perf}
All zynq platforms always used the 64 bit AXI DMA interfaces in the
zynq chip, but now the SDP/DMA FPGA modules are also 64 bits wide
whereas they used to be 32 bits wide.  This allows the DMA to have
higher throughput and no idle cycles when producing continuous 32 bit data.\\

With the exception of zynq ultra, zynq platforms now have the option of using cache coherent DMA.\\

Options may now be specified to build both the framework itself and software assets (RCC workers, ACI programs) with compiler optimizations, alongside the existing default build for best debugging.  I.e., both the default debug builds as well as the optimized builds coexist in the source tree installation, and both can be built and used.  The ``\code{--optimize}'' option applies to the \code{opencpi-setup.sh} script (to use the optimized framework build) as well as the \code{ocpiadmin install platform} and the \code{ocpidev build} commands (to perform an optimized build).  An alternative way to enable building with optimization is to use a ``\code{-o}'' suffix at the end of software platform names: the idea is that anywhere in the CLI you have a software platform, you can qualify it with build options and it creates a ``pseudo platform'' with the specified option, which does not interfere with the default platform (without the suffix).  This applies to \code{ocpiadmin install platform}, \code{ocpidev build --rcc-platform}, and \code{ocpiremote load --rcc-platform}.  When running applications with RCC workers, when both debug and optimized RCC workers are built (i.e. both artifacts are available in \code{OCPI\_LIBRARY\_PATH}), preference is given to the worker whose optimization setting matches the optimization setting of the container in which it is executing.\\

\code{ocpiremote} supports the ``\code{--optimize|--optimized}'' option to specify that the optimized RCC platform build products should be used.


\subsection{OCPI\_ROOT\_DIR Environment Variable}
\label{sec:21_rootdir}
Files in scripts/programs may now be referenced relative to the OpenCPI ``root'' directory, as well as the ``cdk'' directory.  The following scripts have been modified to take advantage of the new \code{OCPI\_ROOT\_DIR} environment variable: \code{opencpi-setup.sh}, \code{zynq\_setup.sh}, \code{zynq\_net\_setup.sh}, and \code{ocpiserver.sh}.

\subsection{e3xx OSP}
\label{sec:21_e3xx}
The \code{e31x} platform project is now based on \code{xilinx19\_2\_aarch32} instead of \code{xilinx13\_4}.

\subsection{\code{timestamper\_scdcd-spec.xml} Properties}
\label{sec:21_tsprop}
The \code{timestamper\_scdcd} spec file properties now include ``\code{samples\_per\_timestamp}'' (replaces ``\code{min\_num\_samples\_per\_timestamp}'') and ``\code{sampling\_interval}''.

\section{Changes and Notes}

\subsection{\code{ocpigen}}
\label{sec:21_ocpigen}
64-bit initial values for 64-bit HDL worker parameters are now handled correctly.

\subsection{\code{ocpiremote} Option Standardization}
\label{sec:21_ocpiremote}
The \code{ocpiremote} command options have been updated to match those used in other commands.  Specifically, \code{ocpiremote} now understands ``\code{--rcc-platform}'', ``\code{--hdl-platform}'', and ``\code{--verbose}''.  While ``\code{--sw\_platform}'' and ``\code{--hw\_platform}'' are still allowed, these options are now deprecated.

\subsection{\code{platform\_pkg} Updates}
\label{sec:21_platpkg}
The ``\code{usingPPS}'' signal was added to the \code{time\_base\_out\_t} record in \code{projects/core/hdl/primitives/platform/platform\_pkg.vhd}.  Platform workers need to drive this signal either high or low depending on their configurations and whether a PPS is being used.\\

The ``\code{time\_base\_out\_t.reset}'', ``\code{time\_base\_out\_t.ppsIn}'', ``\code{time\_base\_in\_t.ppsOut}'', and ``\code{time\_service\_t.reset}'' signals have been deprecated and should no longer be used.  Platform workers should no longer drive ``\code{timebase\_out.reset}'', ``\code{timebase\_out.ppsIn}'', or ``\code{timebase\_in.ppsOut}''.

\section{Major Known Deficiencies}
\label{sec:21_bugs}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 2.1:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

% === End of 2.1.0

\origsection{Release 2.0.0}
\def\ocpiversion{v2.0.0}
\section{Enhancements}

\subsection{Deprecations}
\label{sec:20_deprecations}
The following have been marked as ``deprecated'' and support has been been removed in OpenCPI 2.x.
\begin{itemize}
\item CentOS 6 reaches end-of-life on 30 Nov 2020 and will no longer receive updates or security patches by the CentOS maintainers. Because of this, OpenCPI has dropped support for CentOS 6 as a development platform and an RCC runtime platform.
\end{itemize}

\subsection{Binary Distribution Builds}
\label{sec:20_binary_distribution}
For parties interested in providing OpenCPI binary packages for distribution, the \code{OCPI\_{}DISTRO\_{}BUILD} environment variable has been added.  If set to "1", OpenCPI build/installation scripts will produce binaries that can be run on any supported x86\_{}64 platform.

\subsection{CentOS 8}
\label{sec:20_centos8}
Support for CentOS 8 as an RCC only development platform has been added. HDL support will be made available when vendor tools support CentOS 8. CentOS 7 is still the recommended development platform for new and existing OpenCPI projects.

\subsection{Digital Radio Controller for E31x}
\label{sec:20_digital_radio}
Adds digital radio controller (DRC) implementation for E31x platform. FSK app \code{fsk\_{}dig\_{}radio\_{}ctrl} is updated to show RX, TX, TXRX and is capable of being run using both \code{ocpirun} and ACI app.

\subsection{Man Pages}
\label{sec:20_man_pages}
Additional man pages for \code{ocpidev} nouns are available. This includes man pages for: \code{ocpidev-application}, \code{ocpidev-assembly}, \code{ocpidev-card}, \code{ocpidev-component}, \code{ocpidev-device}, \code{ocpidev-library}, \code{ocpidev-platform}, \code{ocpidev-primitive}, \code{ocpidev-protocol}, \code{ocpidev-registry}, \code{ocpidev-slot}, \code{ocpidev-subdevice}, \code{ocpidev-test}, \code{ocpidev-worker}.\\

New man pages include: \code{ocpiadmin}, \code{ocpidriver}, \code{ocpihdl}, \code{ocpiremote}, \code{ocpirun}, \code{ocpiserve}, \code{ocpiview}\\

When the OpenCPI environment is setup using \code{opencpi-setup.sh}, the man pages can be viewed using the man command, e.g. \code{man ocpidev}.\\

Man pages are also available in HTML form at \code{\${}OCPI\_{}CDK\_{}DIR/doc/man/html} including cross references between man pages.

\subsection{\code{ocpiadmin}}
\label{sec:20_ocpiadmin}
A new command line tool \code{ocpiadmin} has been added. This new tool replaces \code{scripts/install-platform.sh} and \code{scripts/deploy-opencpi.sh} on source-installed OpenCPI development platforms. Usage of \code{ocpiadmin} requires the OpenCPI environment be setup.\\
Example usage of \code{ocpiadmin}:
\begin{lstlisting}
# Required
source cdk/opencpi-setup.sh -s

# Install xsim platform
ocpiadmin install platform xsim

# Install e31x platform
ocpiadmin install platform e31x -p ocpi.osp.e3xx

# Additional help
ocpiadmin install --help
\end{lstlisting}

\subsection{Optional Slave Support}
\label{sec:20_optional_slave_support}
Optional slaves means these things:
\begin{itemize}
\item the proxy developer can declare that slaves are optional (the app can leave some out)
\item the proxy developer can use a runtime query to see if a slave it declared as optional, is in fact present or not.
\item the app developer can specify only a subset of the slaves of a proxy
\item the attributes in the slave element in the OAS use ``slave" and ``instance" rather than ``name"
\end{itemize}

\subsection{Proxy Slaves}
\label{sec:20_proxy_slaves}
When a proxy instance in an application specifies no slaves, the application will be searched for possible slaves that belong to that proxy (that are the right worker).  If this is ambiguous there will still be an error.

\subsection{Selection Expressions}
\label{sec:20_selection_expressions}
The ``worker'' variable is now available in selection expressions, and the ``worker'' attribute of application instances can now include the authoring model suffix.

\subsection{Ubuntu 18.04}
\label{sec:20_ubuntu18}
Support for Ubuntu 18.04 as a full development host has been added. Ubuntu 18.04 is the only platform that supports OpenCPI integration with GNU Radio's ``GNU Radio Companion''. Developers and users of OpenCPI looking to use Ubuntu as a development host platform instead of CentOS are highly encouraged to use Ubuntu 18.04 instead of Ubuntu 16.04.

\subsection{Xilinx RCC Platforms}
\label{sec:20_xilinx_rcc_platforms}
Support for additional Xilinx platforms as been added. New additions include: \code{xilinx13\_{}4\_{}arm}, \code{xilinx17\_{}1\_{}aarch32}, \code{xilinx17\_{}1\_{}aarch64}, \code{xilinx17\_{}2\_{}aarch32}, \code{xilinx17\_{}2\_{}aarch64}.\\

These new platforms, along with existing platforms, can be built using the new \code{ocpiadmin} tool.


\section{Changes and Notes}

\subsection{Component Library Searching Algorithm}
\label{sec:20_component_library_searching}
Component Libraries are searched per project, with all indicated libraries searched in a project before moving to the next project. Previously, this was ``library first'' which caused confusing results. If a worker in an assembly is found in a library, it is chosen even if not built for the target platform. This is to maintain consistency between library searching that is target-independent with library searching by tools that is target-dependent.

\subsection{\code{ocpigen}}
\label{sec:20_ocpigen}
The ``built-in'' properties are now ``hidden'' from the property dump display unless explicitly enabled.

\subsection{PlutoSDR RCC Platform Support}
\label{sec:20_plutosdr}
PlutoSDR RCC platform has been updated to use new version 0.32. Installation of the platform no longer builds pluto.frm image as pre-built image by Analog Devices can be used directly. Cross compiler tools have also been updated to use Xilinx version 2019.2 and no longer require a separate installation of Xilinx 2018.3 SDK. NFS is not supported in this version of the kernel which implies drop of support for network mode; standalone and remote modes are still supported.

\subsection{Primitive Libraries \code{util} and \code{bsv}}
\label{sec:20_util_bsv_library}
The util and bsv primitive libraries are not automatically made available to workers, to reduce namespace pollution. Primitive libraries are transitive - if a worker needs a library, the assembly automatically knows that and you do not have to mention the primitive library for the assembly.\\

The bsv library usage is deprecated and it is now scoped in VHDL by the name of the package it exists in, so that a typical usage in VHDL is: \code{library ocpi\_{}core\_{}bsv; use ocpi\_{}core\_{}bsv.all}\\

In general, primitive libraries can be labeled as being qualified by the package id of the project it is in, so that a developer does not need to now if the library name is used elsewhere.

\subsection{Test Bitstream \code{testbias}}
\label{sec:20_testbias}
The test bitstream \code{testbias} is always exported and exists at the top of the framework's directory for the HDL platform. This same file is made available for SD cards as well as when using \code{ocpiremote} to run a remote system.

\subsection{Tutorials}
\label{sec:20_tutorials}
More of the assets created in the tutorials are now in the tutorial project.

\section{Major Known Deficiencies}
\label{sec:20_bugs}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 2.0:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1113}
\item \bugref{1392}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

% === End of 2.0.0

\origsection{Release 1.7.0}
\def\ocpiversion{v1.7.0}
\section{Enhancements}
\subsection{ADC/DAC Clocking Architecture}
\label{sec:17_adc_dac}
A new clocking and timestamping model has been implemented for ADC and DAC devices that is expected to be rolled out across all HDL platforms and devices for 2.0.  It simplifies some device workers, minimizes clock-domain crossing and time-jitter for sample data, as well as supports the \code{ComplexShortWithMetadata} protocol more directly. All new device support for ADC/DAC/transceiver devices should use this model.  It is described in the \githubio[OpenCPI Platform Development Guide]{OpenCPI_Platform_Development_Guide.pdf}, section 5.5.9.  For 1.7 it is implemented on the e31x and zed+fmcomms platforms.

\subsection{Built-in \code{platform} Project}
\label{sec:17_platform_project}
The new built-in \code{platform} project contains reference platforms and support for generic devices and cards. The \code{zed} and \code{zed\_{}ise} platforms have been moved to this project, with future reference platforms expected to follow. Most device support in the built-in \code{assets} project is expected to migrate to the \code{platform} project for 2.0. Any OSP project which relies on such generic support or reference platforms should include \code{ocpi.platform} as a project dependency. See the README file in this new built-in project for more details.

\subsection{CIC Decimator RCC work-a-like}
\label{sec17_cic_dec}
An RCC work-a-like of the \code{CIC\_{}Dec.hdl} worker has been added to the built-in project ``assets''.

\subsection{Clock Generator Primitive}
\label{sec:17_clocking}
A new clocking library has been added to \path{core/hdl/primitives}. This is a preliminary view of how OpenCPI will handle vendor clock generator support.

\subsection{Man Pages}
\label{sec:17_man_pages}
Man pages are available for the \code{ocpidev} command and its subcommands. When the OpenCPI environment is setup using \code{opencpi-setup.sh}, the man pages can be viewed using the man command, e.g. \code{man ocpidev}.

\subsection{\code{ocpiremote}}
\label{sec:17_ocpiremote}
\code{ocpiremote.py} was added to remove, or reduce, the need for setting up NFS for the purposes of remote application execution and development. When the OpenCPI environment is setup using \code{opencpi-setup.sh}, running \code{ocpiremote --help} will list available subcommands. Additional help for each subcommand is available via \code{ocpiremote <subcommand> --help}.

\subsection{PlutoSDR HDL Platform Support}
\label{sec:17_plutosdr}
Support for plutosdr platform based on adi\_{}plutosdr0\_{}31 RCC platform has been added. The plutosdr platform is the cheapest starter platform for OpenCPI, featuring a Zynq 7010 FPGA and AD9363 transceiver chip on the same board.\\

\textit{\textbf{Note:}} Xilinx SDK 2018.3 is required to build the framework, RCC artifacts, and ACI executables for the plutosdr platform.

\subsection{Protocol complex\_{}short\_{}samples}
\label{sec:17_css}
A new protocol, \code{complex\_{}short\_{}samples}, has been added which is intended to be used for streaming complex data and metadata commonly associated with SDR applications. For expansion of future capabilities, this protocol includes an operation for user-defined metadata. This protocol is expected to replace \code{ComplexShortWithMetadata} in future releases.

\subsection{Ubuntu 16.04 Support}
\label{sec:17_ubuntu_16.04}
Users now have the option of using Ubuntu 16.04 as their host development platform. The level of support for Ubuntu 16.04 is the same as CentOS 7.

\subsection{zcu104 HDL Platform Support}
\label{sec:17_zcu104}
Support for the zcu104 platform based on xilinx19.2 aarch64 RCC platform has been added. The zcu104 platform is like the zed platform: the cheapest ``reference'' platform for the zynq-ultrascale processor line, that
also can support the ad9361.\\

\textit{\textbf{Note:}} Vivado 2019.2 is required to build artifacts for the zcu104 platform. Vivado 2019.2 is not supported on CentOS 6.


\section{Changes and Notes}
\subsection{\code{ComplexShortWithMetadata} Changes}
\label{sec:17_cswm}
Removed \code{user} opcode and further clarified the descriptions of the \code{sync} and \code{end\_{}of\_{}samples} opcodes. This protocol is finalized, meaning little to no future changes.

\subsection{MacOS 10.14 and 10.15}
\label{sec:17_mojave}
Both MacOS 10.14 (Mojave) and MacOS 10.15 (Catalina) have been requalified as RCC-only platforms, which can still be used as a client for remote containers. Support for these RCC-only platforms relies on MacPorts already being installed on the user's system.

\subsection{Optional HDL Ports with \code{clockdirection=in}}
\label{sec:17_hdl_clockdirection}
Optional HDL worker ports that have the ``clockdirection" attribute set to ``in" are now supported.

\subsection{Python Scripts}
\label{sec:17_python_scripts}
Removed all Python 2 related packages and dependencies for OpenCPI. On CentOS 6, there are still python 2 related packages being installed as the \code{gpsd} prerequisite requires python 2 for SCons.\\

The shebangs in all OpenCPI python scripts have been changed from \code{\#{}!/usr/bin/env python3.4} to\\ \code{\#{}!/usr/bin/env python3} allowing for greater portability across operating systems that provide different python 3.x versions.\\

All OpenCPI python scripts have had their execute bit set so they can be executed directly without having to explicitly invoke a python interpreter.\\

\textit{\textbf{Note:}} OpenCPI requires at least python 3.4 and does not use any newer features added in later versions of python 3. This minimal version requirement is based on what is available for CentOS 6. OpenCPI installation on CentOS 7 installs and uses python 3.6 and related packages.

\subsection{SCons 3}
\label{sec:17_scons3}
Related to python 3 changes, the SCons dependency was updated from SCons 2 to SCons 3 on CentOS 7. Due to how SCons is packaged for CentOS 7, one cannot have both \code{scons} and \code{scons3} RPMs installed due to conflicts with the RPMs. SCons is used for building the \code{gpsd} prerequisite.

\subsection{SD Card Export Model}
\label{sec:17_sd_card}
The process of generating SD cards for embedded systems was revamped and simplified.  In particular the syntax for the platform exports files was changed/enhanced.  Developers of platforms should read the appropriate section in the \githubio[OpenCPI Platform Development Guide]{OpenCPI_Platform_Development_Guide.pdf}.  The change reduces the requirements to change the embedded system's root file system from the manufacturers default.

\section{Major Known Deficiencies}
\label{sec:17_bugs}

\subsection{HDL Platform zed\_{}ise Build Error}
\label{bug:1113}
Known issue with building HDL platform \code{zed\_{}ise}. See \href{https://gitlab.com/opencpi/opencpi/-/issues/1113}{\#{}1113} for status of this issue.

\subsection{Remote Development using Network Mode Scripts}
\label{bug:1117}
Known issue related to using network mode scripts for remote development (ex. \code{mynetsetup.sh}). Status can be tracked here: \href{https://gitlab.com/opencpi/opencpi/-/issues/1117}{\#{}1117},  \href{https://gitlab.com/opencpi/opencpi/-/issues/1204}{\#{}1204}

\subsection{RPM Support}
\label{bug:17_rpms}
RPMs are not supported in OpenCPI 1.7.0. Support will be added in OpenCPI 2.0.0.

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 1.7:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2400}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

% === End of 1.7

\origsection{Release 1.6.0}
\def\ocpiversion{v1.6.2}  % Need to redefine so doc links are correct
\section{Enhancements}
\subsection{Support for Workers with Separate Control and Data Clocks} % AV-3840
\label{sec:16_clocks}
Each worker data port can now declare whether the clock domain of the port's signals is:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item The same as the control port and clock (as before, which is still the default)
\item Based on an output clock driven by worker code, indicated using the \code{clockDirection='out'} attribute
\item Based on an input clock accepted into the port, indicated using the \code{clockDirection='in'} attribute
\item The same as some other port of the worker, indicated using the \code{clock='\textit{other-port-name}'} attribute
\end{itemize}
One important use case for this is for all data communication and data processing to happen in a clock domain
different from the control clock domain.
When worker ports are connected that are in different clock domains, a clock-domain-crossing adapter is inserted which is conservative with respect to the relative clock rates and phasing.

For more information, consult the \githubio[OpenCPI HDL Development Guide]{OpenCPI_HDL_Development_Guide.pdf}.

\subsection{Issues Database for OpenCPI is now Publicly Accessible}
\label{sec:16_issues}
Prior to this release, the issues/bug database used by the active OpenCPI developers and maintainers was private and not visible.  Now the OpenCPI developers and maintainers use the GitLab issues database that is associated with the new public GitLab repository at \url{gitlab.com/opencpi/-/issues}.

\subsection{Source Installation Simplified}
\label{sec:16_install}
When installing from source,  various steps of installation, including the AV GUI installation and cross-building for embedded software and FPGA platforms, requires fewer steps and less complexity. Installation of an FPGA simulator has also been simplified since the Vivado WebPack package no longer requires any licensing at all.  See the \githubio[OpenCPI Installation Guide]{OpenCPI_Installation_Guide.pdf}.

\subsection{Time Service Interfaces were Upgraded for better Timestamping Support}
\label{sec:16_time}
For platform developers, the properties of the \code{time\_server} worker instantiated in all platform configurations have been updated and clarified.  The VHDL signals associated with the timebase and timeservice platform port types have new signals.  The time service now supports the indication as to whether the time values come from valid GPS-based time.  Platforms with GPS receivers connected to CPU serial ports (e.g. Ettus e310) enable time values provided on worker time interfaces to be GPS-based time values.  This is a technology preview until the next release when most supported platforms will use this capability to provide GPS-based timestamping to workers.

\subsection{New Features for Simplifying ADC/DAC Devices Workers and Enabling Timestamping}
\label{sec:16_adcdac}
For platform developers, special workers have been developed to allow the data ports of ADC and DAC device workers to remain in the sample clock domain and not be involved in timestamp injection.  These are a technology preview
until the next release when they will be used for supported platforms.  See the specs and workers for \code{data\_src\_adc} and \code{data\_sink\_dac} in \code{projects/assets/hdl/device/}.  Similarly there is now a new timestamping worker that receives inputs in the sample clock domain.  See \code{timestamper\_sdcd} in \code{projects/assets/components/util\_comps}.

\section{Changes and Notes}
\subsection{Repository of OpenCPI moved to GitLab.com}
\label{sec:16_repo}
The git repository site where OpenCPI is hosted and actively maintained is now \code{gitlab.com}.  The documentation for releases is found at \url{opencpi.gitlab.io}.

\subsection{Project with Content for Tutorials is in the Core Repository}
\label{sec:16_tutorial}
The project used for tutorials which was previously in a separate training repository is now in the core OpenCPI repository under \code{projects/tutorial}.

\subsection{MacOS Catalina (10.15) is now Supported for Software Only (no FPGA) Development.}
\label{sec:16_macos}
Software only development (no FPGA tools or simulators) is supported on MacOS Catalina.  It relies on the \code{macports} package manager already being installed on the system, from \url{macports.org}.

\subsection{The gpsd package is now a prerequisite for all OpenCPI systems.}
\label{sec:16_gpsd}
OpenCPI now has a core dependency on this package (\url{gpsd.gitlab.io/gpsd}) and it will be built for all development hosts and embedded systems and used in a way that will not conflict with systems that already have \code{gpsd} installed.

\subsection{Optional Environment Settings for a Source Installation are in a New File.}
\label{sec:16_userenv}
All environment settings for OpenCPI (which are all optional), should be set in the \code{user-env.sh} file at the top
level of the installation.  This file is automatically read when the OpenCPI environment is established.

\section{Major Known Deficiencies}
\label{sec:16_bugs}

\subsection{RPM Installation is not Supported in Release 1.6.0}
\label{bug:norpm}
In the initial 1.6.0 release of 1.6, RPM installation is not supported.  Only source installation is supported, as described in the \githubio[OpenCPI Installation Guide]{OpenCPI_Installation_Guide.pdf}.  RPM installations will be supported by the next minor release.


\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 1.6:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2400}
\item \bugref{2477}
\item \bugref{3783}
\item \bugref{2811}
\end{itemize}

The following previously-documented deficiencies have been fixed in this release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{2241}
\item \bugref{3193}
\item \bugref{4307}
\end{itemize}

% === End of 1.6

\newpage
\origsection{Release 1.5.0}
\def\ocpiversion{v1.5.0}  % Need to redefine so doc links are correct
\section{Enhancements}
\subsection{New Digital Radio Controller Front-End Control Paradigm} (Technology Preview) % AV-3840
\label{sec:15_drc}
This release includes a new OpenCPI Specification File (OCS) which represents the next-generation interface for Radio Frequency (RF) command and control.
This generation improves upon the previous by removing RF vs. Base Band (BB) specificity, allowing for runtime querying of acceptable settings, and supporting multiple RF channels.
Each of these marks an important step towards supporting truly hardware-agnostic RF applications. \\

For more information, consult \path{Dig_Radio_Ctrlr.pdf}.
\subsection{New Time-Based Protocol (``\code{ComplexShortWithMetadata-prot}'') (Technology Preview)} % AV-4804
\label{sec:15_protocol}
One of the major improvements as of 1.5 is to have timestamped data flow from end-to-end using the ``RxApp'' on an E3xx example platform. To achieve this, ``\path{ComplexShortWithMetadata-prot}'' was created. The source to this Protocol (\path{<core>/specs/}) has various comments explaining the new opcodes and arguments as well as example usage.
\subsection{New Time-Based Assets Project (``\code{assets\_ts}'') (Technology Preview)} % AV-5217
\label{sec:15_assets_ts}
The workers required to achieve the previously mentioned goal of timestamped data within ``RxApp'' were derived from those within ``assets'' but are now in their own Project, ``assets\_ts''. This Project mostly exists to work around current limitations within the Framework; whether or not it will continue to exist or if the timestamped versions will return to ``assets'' is still to be determined.

\subsection{New HDL Worker Port Interfaces} % AV-4961
\label{sec:15_smart_wrappers}
A new HDL Worker port interface is now available that considerably reduces code complexity when a Worker ``doesn't care'' about message boundaries, \textit{e.g.} when streaming sequences of data. This interface is currently requested by noting in the OWD that it is ``\texttt{version=2}'' and this interface will become the default in OpenCPI 2.0. Additional information can be found in the \textit{HDL Development Guide}.

\subsubsection*{Some Workers Migrated} % AV-5341
\label{sec:15_v2_workers}
Some of the HDL Workers' source have been updated to use this new ``\texttt{version=2}'' interface to exemplify its usage, while the ``version 1'' (pre-1.5) Worker source code has been migrated to the ``inactive'' Project.
This \textit{should not affect} any applications that previously used these Workers, except the Properties explicitly affecting buffer sizes are now silently ignored.
The following Workers have been upgraded in this way:

\begin{itemize}
\setlength\itemsep{0em} %tighten
\begin{multicols}{3}
\item[] \path{agc_real.hdl}
\item[] \path{cic_dec.hdl}
\item[] \path{cic_int.hdl}
\item[] \path{dc_offset_filter.hdl}
\item[] \path{mfsk_mapper.hdl}
\end{multicols}
\end{itemize}

\subsection{\ocpidev Improvements} % AV-3298 et al
\label{sec:15_ocpidev}
The \ocpidev tool has been significantly improved, including:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item ability to show \code{utilization} of various HDL Workers and Assemblies % AV-3298
\item \code{show component} shows information about Components, including Properties and Ports % AV-5034
\item \code{show worker} information about Workers, including Properties and Ports % AV-4116
\end{itemize}
See \ref{sec:15_ocpidev_changes} for \ocpidev command changes.
\subsection{New ``Zed'' RCC Platform: \code{xilinx13\_4}} % AV-4848
\label{sec:15_new_zed_rcc}
With the introduction of the RCC Platform \path{xilinx13_4} to support the E310 in 1.4, with release 1.5 there are now RPMs available pairing the Zed with both \path{xilinx13_3} and \path{xilinx13_4}. The RPMs follow the naming convention \textit{opencpi-hw-platform-zed-\textless RCCPlatform\textgreater}. See the \textit{Zed Getting Started Guide} for more information.
\subsection{\code{gdb} and \code{rsync} Provided on \code{xilinx13\_3} and \code{xilinx13\_4} RCC Platforms} % AV-5094
Both of these tools are very helpful with development and an ARM-compiled version is now provided in the SD card images provided by OpenCPI. Out of the box, \path{rsync} must be run \textit{from the radio} targeting the development host; more information is available in the applicable \textit{Getting Started Guides}.
\section{Changes and Notes}
\subsection{Deprecation of the ``Readable'' Attribute}
\label{sec:15_readable}
The ``\code{readable}'' Property Accessibility Attribute has been deprecated and replaced with ``\code{readback}.'' \textit{However}, its use case is very rare and specific; by default all Properties are ``readable'' in the usual context of the term.
Additional information can be found in the \textit{Component Development Guide}.

\subsection{Deprecation of Zipper RF Interface Board}
\label{sec:15_zipper} % AV-5257
The \href{https://wiki.myriadrf.org/Zipper_Interface_Board}{Myriad RF Zipper Interface Board} has been unavailable for purchase for a considerable time. While OpenCPI still \textit{theoretically} supports it, limited available quantities have resulted in its removal from the list of officially supported (and therefore tested) platforms. Support infrastructure has been moved to the ``\texttt{inactive}'' project.
\subsection{E3xx PPS Discipline}
\label{sec:15_e3xx_gps} % AV-4994
The ``e3xx'' Platform Worker timebase interface's PPS disciplining was previously limited to only the E310/E312's ``SYNC'' SMB connector (GPS PPS disciplining was not possible). The source selection is now exposed as a parameter on the Platform Worker.
\subsection{``\code{new\_project\_source}'' script removed} % AV-4482
\label{sec:15_new_project_source}
The utility script noted in \ref{sec:13_restructure} has been replaced by the more versatile ``\path{ocpi-copy-projects}'' script. This new utility is in the user's path and has a ``\texttt{--help}'' option.
\subsection{RCC Worker Parameter Macros Stricter} % AV-5105
If an RCC Worker had been using the undocumented / internal ``macro form'' of a parameter, \textit{e.g.} ``\path{PARAM_biasValue()}'', that form will no longer work. Instead, RCC Workers \textit{must} use the documented form, \textit{e.g.} ``\path{BIAS_PARAM_BIASVALUE}''\footnote{These examples are from the \path{bias_param.c} worker, comparing 1.4 to 1.5.}.
\subsection{\ocpidev Changes}
\label{sec:15_ocpidev_changes}
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item The \code{show projects} command no longer shows tests and primitives with low verbosity (``\path{-v}''); use high verbosity instead (``\path{-vv}'')\footnote{Any automated parsing of data should be using JSON interface, which also needs this additional verbosity.}. % AV-4963
\end{itemize}
\subsection{``\code{myClock}'' HDL Code Deprecated / Removed} % AV-5235
\label{sec:15_myclock}
While revamping and examining the framework's ability to use multiple clocks within HDL Workers, it was found that the ``\code{myClock}'' capability was documented but likely never fully worked. This feature is \textit{planned} to be restored \textit{and tested} for the 1.6 release using a different XML attribute name.
\subsection{Infrastructure OWDs Moved} % AV-5172 AV-5173 AV-5174 AV-5175
Various OWDs\footnote{The OWDs explicitly were \path{metadata.xml}, \path{ocscp.xml}, \path{time_client.xml}, and \path{unoc_node.xml}.} were incorrectly located within the ``core'' Project's ``\path{specs}'' directory, even though they are infra\-structure Workers that an end user shouldn't need to be concerned with. They have been moved out to reduce confusion and clutter.
\subsection{RPM Upgrade Notes} % AV-5245
Some previous RPM-based installations may not have proper dependencies documented for some sub-packages, \textit{e.g.} version 1.4 of \path{opencpi-hw-platform-e3xx-xilinx13_4} requires ``\path{opencpi},'' not \textit{explicitly} ``\path{opencpi} version 1.4.'' This may cause version mismatches when upgrading; \textbf{ensure all packages currently installed on a system are \textit{explicitly} added to the \path{yum} command line when upgrading.}

\subsection{HDL Wrapper Changes} % AV-5271
\label{sec:15_hdl_wrappers}
The internal ``wrapper'' that encapsulates an HDL Worker has changed considerably (see \sref{sec:15_smart_wrappers}).
This has changed the pipeline depths of the inputs and outputs of the Workers.
\textbf{This \textit{should not affect} any users; an Application should \textit{never} make assumptions concerning, or require specific relationships between, the timing of data between Workers\footnote{Other ways timing may be affected would include backpressure from upstream Workers, network latency between remote Containers,  etc.}.}
However, if developers previously made implementation-specific assumptions, their Applications will now fail and will need to be fixed to properly use the Framework to transport \textit{all} required data and metadata.

\section{Major Known Deficiencies}
\label{sec:15_bugs}

\subsection{``udev'' Radio Rules Sometimes Does Not Work} % AV-5275
\label{bug:5275}
Starting with 1.4, some RPMs pre-install symlinks for rules in \path{/etc/udev/rules.d/} for certain radio platforms, \textit{e.g.} a rule to create a symlink from \path{/dev/matchstiq_z1_0} to \path{/dev/ttyUSB0}.
\input{snippets/udev_Reread}

\subsection{Emulators Not Constrained To Specific Containers In Unit Tests} % AV-5496
\label{bug:5496}
When an emulator-based test harness is built for multiple simulators (\textit{e.g.} ``isim'' and ``xsim''), running the unit test does not guarantee that all workers are running on the same container.
For example, when ``\path{lime_dac_ts.test}'' is built for both isim and xsim, test execution could pass for isim, but might later fail with xsim.
Review of the log file shows that the emulator worker is erroneously running on an isim container and not the expected xsim container.
The recommended workaround is to only build and test for a \textit{single} simulator at a given time, ensuring there is only one artifact that satisfies the test's requirements.

\subsection{Provided LiquidDSP Build May Link Incorrectly} % AV-5543
\label{bug:5543}
\textit{Note:} This bug \textit{only} affects source-based building; RPM-based users will not encounter this issue.\\

The ``LiquidDSP'' library is provided as a prerequisite of the ``assets'' Project.
It is currently used by one worker, ``\path{complex_mixer.rcc}'', which uses it for its Numerically Controlled Oscillator (NCO).
If the LiquidDSP library is built on a system that has the ``FFTW'' library installed, it will attempt to use it.
However, any user-developed RCC Worker attempting to use LiquidDSP functions that use the FFTW back-end will fail at runtime with an undefined symbol (\textit{e.g.} \path{fftwf_execute}).
The recommended workaround is to use the compiled \path{libliquid} from the RPM installation (\textit{e.g.} \path{/opt/opencpi/cdk/centos7/lib/libliquid.a} or \path{/opt/opencpi/cdk/xilinx13_3/lib/libliquid.a}) or to rebuild the prerequisites without the FFTW libraries installed.\\

This problem was found late within the 1.5 release cycle and will be addressed with the next major release.

\iffalse % Fixed in both RPM and source; will remove block in 1.6
\subsection{``python3'' Symlink Missing} % AV-5477, AV-5478
\label{bug:5477}
Some ``python3'' RPMs do not provide a default symlink from \path{/usr/bin/python3} to their proper executable\footnote{For example, CentOS~7's \path{python34-3.4.10-1.el7.x86_64} does not, while the slightly-older \path{3.4.9-2.el7.x86_64} did.}.
This is not considered a deficiency of the framework itself, but the Python packager.
If your system does not have \path{/usr/bin/python3}, a system administrator needs to create one for you pointing to your installation of Python3, \textit{e.g.} ``\code{cd /usr/bin; sudo ln -s python3.4 python3}'' for Python 3.4.
The \path{opencpi-devel} RPM works around this by installing a symlink, but non-RPM users \textit{may} need to manually create the symlink.
\fi

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 1.5:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2241}
\item \bugref{2400}
\item \bugref{2477}
\item \bugref{3193}
\item \bugref{3783}
\item \bugref{2811}
\item \bugref{4307}
\end{itemize}

The following previously-documented deficiencies have been fixed in this release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{4173}
\item \bugref{4278}
\item \bugref{4486}
\item \bugref{4526}
\end{itemize}

% === End of 1.5

\newpage
\origsection{Release 1.4.0}
\def\ocpiversion{v1.4.0}  % Need to redefine so doc links are correct
\section{Enhancements}

\subsection{Support for Ettus E310 Platform} % AV-4247
\label{sec:14_e310}
The Ettus Research USRP E310 is now supported within the OpenCPI framework. This includes the changes to the AD9361 device workers for using a CMOS interface, increasing the number of modes that the framework supports\footnote{AD9361 LVDS signaling has been supported since 1.3; cf. \ref{sec:13_ad9361}.} There is currently a limitation of a single TX and RX channel being supported; see the \textit{E3xx Getting Started Guide} for more information.

\subsection{Component Unit Test Enhancements} % AV-3149 and many other tickets
\label{sec:14_test}
The provided Component Unit Test infrastructure has been enhanced to automatically incorporate elements that address common issues when developing HDL workers:
\begin{enumerate}
\setlength\itemsep{0em} %tighten
\item Input message metadata manipulation applied to the Unit Under Test's (UUT) input port(s) helps ensure an HDL Worker can properly handle various message-protocol edge conditions, \textit{e.g.} start-of-message without data until a later clock. \textbf{This manipulation is \textit{not} enabled by default.}
\item Output message throttling applied to the UUT's output port(s). Not respecting ``backpressure'' is often the reason an HDL Worker fails on a ``real'' hardware platform after passing all tests within a simulation. \textbf{This backpressure is now enabled in \textit{all} test benches by default.}
\end{enumerate}
Exercising Workers in this manner during the simulation design phase has been shown to greatly increase the likelihood of success on physical hardware. More information can be found in the \textit{Component Development Guide}.

\subsection{Multi-Slave Proxy Support} % AV-2448
\label{sec:14_multislave}
Previously, a Proxy Worker could only represent a single Worker but not a collection of Workers that had related functions, \textit{e.g.} the transmit and receive paths of a single RF link. This resulted in various workarounds that are not officially supported by the Framework. For example, one user had a Proxy ``peeking'' into the Application to find peer Workers: this does not work with Remote Containers with the Application on another physical machine. Now a Proxy can (optionally) define more than one slave Worker with full interface compatibility with previous implementations \footnote{The interface of using an object named ``\code{slave}'' remains. The type of the object is considered an implementation detail and \textit{has} changed.}. More information can be found in the \textit{Component Development Guide}.

\subsection{Transmit Blanking / Powerdown for DACs} % AV-4273
\label{sec:14_blanking}
Both the AD9361 and LIME DACs are now blanked / powered down\footnote{Implemented by TX RF carrier suppression} when not in use. To perform this on-demand, they use a new ``\code{tx\_event}'' Port/Protocol, as well as properties exposed in their proxies. See the respective Worker datasheets for more details. \textbf{This added capability resulted in a change to the \code{qdac-spec} that may affect current user applications.} If an application used \code{connect=qadc} (\code{connect} attribute), that application will require an additional \code{to} attribute specified directing it to explicitly use the \code{IN} input port.

\subsection{\ocpidev Improvements} % AV-3439 et al
\label{sec:14_ocpidev}
The \ocpidev tool has been significantly improved, including:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \code{run} some Applications
\item \code{run} Unit Tests
\item \code{show} Unit Tests within a Project
\item \code{show} additional Project information
\end{itemize}
See \ref{sec:14_ocpidev_changes} for \ocpidev command changes.

\subsection{VHDL-Native Pattern and Capture HDL Workers} % AV-4118
\label{sec:14_pattern_capture}
The \code{pattern\_v2} and \code{capture\_v2} Workers have been written from the ground up in VHDL to replace the machine-generated Verilog-sourced \code{pattern} and \code{capture} Workers. \textbf{These latter Workers are now considered deprecated.} The new Workers include fully-functional test benches and data sheets. Platform and BSP Developers will find these Workers to be very useful when debugging various issues related to low-level OpenCPI development.

\subsection{New Documentation RPM} % AV-4267
\label{sec:14_docrpm}
In addition to the PDF-based documentation available at \href{http://opencpi.github.io/}{github.io}, a new RPM is now included ``\verb+opencpi-doc+,'' which includes most of that documentation. Most of the PDFs are installed into \code{/usr/share/doc/}\footnote{The Fedora/Red Hat standard documentation location.}, but a convenience symlink can be found at \code{/opt/opencpi/documentation.html}. This path should not change across multiple OpenCPI versions and can be passed directly to most browsers, \textit{e.g.} ``\code{xdg-open /opt/opencpi/documentation.html}''. If you receive the RPM directly from the AV team, it may include BSP documentation that is not available on GitHub.

\subsection{Zynq Parts Defined} % AV-4356
\label{sec:14_zynq}
All Zynq-based Xilinx parts that are supported by the current Framework, but not necessarily used in an OpenCPI-supported platform, have been defined within the Framework build system. This means that an end user creating a BSP for a ``larger fabric'' Zynq-7000, \textit{e.g.} xc7z100, will not need to change any Framework files and have all required changes isolated to a single Project. This does \textit{not} include additional platforms that have different internal configurations, e.g. Zynq-UltraScale+ devices.

\section{Changes and Notes}
\subsection{I/Q Data Ordering} % AV-4310 AV-4311 AV-4327
\label{sec:14_iqdata}
As noted in the \textit{HDL Development Guide}, when a Protocol contains a Struct Argument, the first Argument Member defined in the Protocol's XML is \textit{always} in the \textit{least significant} bits of the resulting Port. A good example of the importance of this is the scenario where a Port's default data width is overridden (in the OWD) to present all of a Struct's Members in parallel within a single clock cycle. For example, \code{iqstream\_protocol}'s default ordering is a 16-bit interleaved I/Q data: ``$I_{t=0}, Q_{t=0}, I_{t=1}, Q_{t=1}, I_{t=2}, ...$''. However, if the Worker configures its data Ports to be a width of 32 bits, then the I/Q data is presented as a parallel I/Q sample pair with ``I'' in the \textit{lower} 16 bits and ``Q'' in the \textit{upper} 16 bits, \textit{i.e.}:
\begin{center}
$I_{0}=InPort_{0}[15:0]; Q_{0}=InPort_{0}[31:16]\newline
I_{1}=InPort_{1}[15:0]; Q_{1}=InPort_{1}[31:16]\newline
$
\end{center}
The following Application and Workers were identified as improperly handling \code{iqstream\_protocol} complex data (I/Q) presented in the manner noted above and have been corrected:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \path{assets/components/dsp_comps:}
\begin{multicols}{3}
\subitem \path{cic_dec.hdl}
\subitem \path{cic_int.hdl}
\subitem \path{complex_mixer.hdl}\footnotemark
\subitem \path{complex_mixer.rcc}\footnotemark[\value{footnote}]\footnotetext{See last paragraph as well concerning Property changes.}
\subitem \path{dc_offset_filter.hdl}
\subitem \path{fir_complex_sse.hdl}
\subitem \path{iq_imbalance_fixer.hdl}
\subitem \path{phase_to_amp_cordic.hdl}
\subitem \path{pr_cordic.hdl}
\subitem \path{rp_cordic.hdl}
\end{multicols}
\item \path{assets/hdl/devices:}
\begin{multicols}{3}
\subitem \path{ad9361_dac.hdl}
\subitem \path{lime_dac.hdl}
\subitem \path{lime_dac_ts.hdl}
\end{multicols}
\item \path{assets/applications}
\begin{multicols}{3}
\subitem \path{FSK}
\subitem \path{Rx_App}
\end{multicols}
\end{itemize}

It is important to note that this list includes various DACs as well as the \path{complex_mixer}, meaning that \textbf{user's RF Applications from previous versions of the Framework \textit{may} need to be updated}, \textit{e.g.} to handle this change in the DAC's interpretation of data presented for transmission. Also related to this, the \path{phs_inc} Property of \path{complex_mixer} may require inversion when compared to previous versions.

\subsection{Upgrade Notes}
If you have previous versions of the RPM-based OpenCPI RPMs installed, they must all be manually removed, including the prerequisites. \textbf{There is no automatic upgrade path.} Manually performing ``\code{sudo rm -rf} \path{/opt/opencpi/prerequisities}'' after uninstalling \textbf{all} previous RPMs \textit{may} also be needed.

\subsection{Significant SD Card Layout Changes} % AV-4419
\label{sec:14_sdcard}
There have been significant changes to the layout of the Framework and its support files. These are mostly implementation details that the end user does not need to be concerned with. However, scripts and paths that are used for embedded development (both locally and using NFS mounts) have changed enough that users should wipe any SD cards they have used and follow the directions given in the respective platform's \textit{Getting Started Guide} to create a new one.

\subsection{Intel Quartus and Quartus Pro Version Change} % AV-3972
This release has been tested with Quartus Standard 17.1 which is a newly supported version of the tool. Version 15.1 should still work, but future versions will be tested with 17.1. Additionally, preliminary support for Quartus Pro 17.0.2 is also available within the Framework, but is not used by any platforms at this time.

\subsection{New Input Port ZLM-Handling Primitive} % AV-4484
For an HDL Worker to handle the \textit{de facto} end-of-stream signaling used by the Component Unit Test infrastructure (a ZLM with OpCode 0), a convenience primitive is now available and found at \path{projects/core/hdl/primitives/util/zlm_detector.vhd} with an example implementation shown in the \path{capture_v2.hdl} Worker.

\subsection{Change in QDAC/QDAC\_TS Component Spec}
The QDACs now have two ports. The ``\code{IN}'' ports have not changed, but some applications may need to be updated if they did not explicitly connect to them. See \ref{sec:14_blanking} above for more information.

\subsection{Change in \ocpidev Default Output and Scope}
\label{sec:14_ocpidev_changes}
Some of the output from \code{ocpidev}'s \code{show} has changed to default to being more ``human friendly'' and reporting in a tabular fashion (\code{--table}). Many of these commands retain a \code{--simple} parameter for quick parsing. Most also support \code{--json}, which is the recommended and most stable method of parsing \ocpidev output.\newline

Some of \code{ocpidev}'s \code{show} commands now have the concept of ``scope'' where the user is requesting a list of \textit{somethings} provided by a single project, or \textit{all somethings} available within all registered Projects. At this time, no commands support both of the scoping arguments \code{--global-scope} and \code{--local-scope}. However, to ensure future \ocpidev enhancements remain compatible with user scripts, some commands will force the user to explicitly specify a scope if the ``reasonable'' not-yet-implemented default is not yet ready. For example, in a future release, ``\code{ocpidev show tests}'' will report \textit{all} Unit Tests that are available. That report is not yet available, so the user \textit{must} currently explicitly scope the request with ``\code{ocpidev show tests --local-scope}''. However, something like ``\code{ocpidev show registry --local-scope}'' would make no sense, so will never be supported.

\subsection{Rounding and Truncation in \code{qdac-spec} Workers} % AV-4387 AV-4388 AV-4389
\label{sec:14_rounding}
Various DACs were found to be improperly casting \textit{signed} data to \textit{unsigned} during certain operations, resulting in an overflow when the maximum value was transmitted.

\subsection{HDL Workers Failing Unit Tests That Previously Passed}
If a user experiences Unit Test failures that were not present in previous releases, the most likely cause is that ``backpressure'' is now automatically asserted by default; see \ref{sec:14_test} for details.

\subsection{New Framework Build System} % AV-4362
\label{sec:14_build2}
The OSS OpenCPI Project has migrated the Framework build system to a new custom-made system that produces RPMs directly\footnote{If a user was building custom RPMs (from the \path{releng} directory), the process has changed considerably.} and removes the need for ``prerequisite'' RPMs. If upgrading from a previous RPM-based installation, the prerequisite RPMs might require manual deletion. Any mention of prerequisite RPMs in the Appendices (\textit{e.g.} \ref{sec:11_prereq}) below can likely be ignored.

\subsection{New RCC Platform Configuration} % AV-4371
Prior to 1.4, RCC Platforms were defined in \path{/projects/core/rcc/platforms}. With 1.4, they can be in the \path{/rcc/platforms} directory of any Project. \textit{The Platform Development Guide} defines how RCC Platforms are \textit{now} defined and a condensed migration guide can be found at \path{projects/core/rcc/platforms/README.migrating} .

\section{Major Known Deficiencies}
\label{sec:14_bugs}

\subsection{ZedBoard IP Required Even In Standalone Mode} % AV-4173
\label{bug:4173}
Applications (including XML-only ones) fail if there is not an IP address assigned to the ZedBoard, even when in ``standalone mode.'' If the network connection is not used, forcing a MAC (cf. Section~\ref{bug:2400}) and IP addresses is required. To set a temporary IP address, the command ``\code{ifconfig eth0 192.168.244.244}'' can be used. This problem was found late within the 1.4 release cycle and should be addressed with the next major release.

\subsection{Connection Direction In GUI Assumes XML order} % AV-2811
\label{bug:2811}
When importing hand-written XML into the GUI, the \texttt{to} and \texttt{from} attributes are ignored on connections. This does not affect any XML generated by the GUI.

\subsection{OnlyPlatforms/ExcludePlatforms Does Not Work For Individual Unit Test Cases} % AV-4278
\label{bug:4278}
You can include and exclude platforms at a full-test level, but individual cases currently ignore the directives.

\subsection{Some HDL Workers Will Need To Be Updated When \code{props\_in.raw.address} Width Fixed} % AV-4307
\label{bug:4307}
The ``raw'' address scheme for HDL workers is documented as a 32-bit bus. In testing, it was found that this is currently implemented as only 16 bits. While this has \textit{not} yet been fixed, users should review their own libraries for any Workers that make assumptions concerning the size of the bus. Any \code{raw.address} access should be written in more generic VHDL, \textit{e.g.}:
\begin{lstlisting}[language=diff]
-        event_rawprops.raw.address <= x"0040"; --TXRF modules enable register
+        event_rawprops.raw.address <= (6 => '1', others => '0'); --TXRF modules enable register (0x40)
\end{lstlisting}

\subsection{Default \code{python} Must Be Python2} % AV-4526
\label{bug:4526}
According to the \href{https://www.python.org/dev/peps/pep-0394/}{PEP-394} specification, system-level \code{python} \textit{should} point to a 2.x version of the Python interpreter. Some scripts within the Framework and Unit Tests \textit{require} this configuration.

\subsection{Some \code{ocpi.assets} Workers Have Flow Control Issues} % AV-4486
\label{bug:4486}
The Component Unit Test infrastructure has been enhanced (cf. Section~\ref{sec:14_test}) and deficiencies within some Workers have been revealed during regression testing. The following \code{ocpi.assets} Workers are currently known to have defects which will be fixed in a future release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\begin{multicols}{3}
\item[] \path{bias_ver.hdl}
\item[] \path{cic_dec.hdl}
\item[] \path{cic_int.hdl}
\item[] \path{fir_complex_sse.hdl}
\item[] \path{fir_real_sse.hdl}
\end{multicols}
\end{itemize}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 1.4:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1392}
\item \bugref{2241}
\item \bugref{2400}
\item \bugref{2477}
\item \bugref{3193}
\item \bugref{3783}
\end{itemize}

The following previously-documented deficiencies have been fixed in this release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{1385}
\item \bugref{1585}
\end{itemize}

% === End of 1.4

\newpage
\origsection{Release 1.3.1}
\def\ocpiversion{v1.3.1}  % Need to redefine so doc links are correct
\label{sec:appendices}
\section{Enhancements}
\begin{itemize}
\item All documentation has now been updated to cover 1.3 capabilities and features
\item Bugfixes and enhancements for AD9361
\item Workarounds for bug noted in Section~\ref{bug:3783}
\item USB Blaster \code{udev} rules fixed
\item \code{ocpizynq} tool fixed
\end{itemize}

\section{Changes and Notes}
None to report.
\section{Major Known Deficiencies}
\begin{itemize}
\item \textit{Note}: no other deficiencies from Section~\ref{sec:13_bugs} have been mitigated and all remain.
\end{itemize}
\subsection{PCI Platforms Can Only Transmit Using One Channel} % AV-3783
\label{bug:3783}

The current implementation of the PCI-e Specification (ALST4 and ML605 platforms) only allows DMA transaction from the host to the platform on the \textit{first External Port defined in the Assembly or Container XML}. This means the \textit{input} to any Assembly/Container should be listed first. See
\path{projects/assets/hdl/assemblies/empty/cnt_1rx_1tx_bypassasm_fmcomms_2_3_hpc_LVDS_ml605.xml}
as an example. \textit{This does not affect any Zynq-based platforms.} This problem was found late within the 1.3 release cycle and should be addressed with the next major release.

% === End of 1.3.1

\newpage
\origsection{Release 1.3}
\def\ocpiversion{v1.3.0}  % Need to redefine so doc links are correct
\section{Enhancements}
\label{sec:13_enhancements}
\subsection{OSS Release} % AV-2575 and many other tickets
\label{sec:13_oss}
OpenCPI is now available on GitHub under the OpenCPI Organization. The first release is in a git branch, but full integration is planned in the future. This includes all of the previously-proprietary ``ocpiassets / Assets'' Project, including the Board Support Package (BSP) for Epiq Solutions' Matchstiq Z1.

\subsection{Python and GNU Radio Integration (Technology Preview)} % AV-3699
There are now SWIG bindings available to allow a top-level Python script to use the ACI to manipulate an Application in the same manner as from C++\footnote{This integration is only available on CentOS 7 platforms.}. One use case is a GNU Radio block that allows GNU Radio Companion to handle the entire lifecycle of an OpenCPI Application. This block can handle data flows of complex I/Q streams or any primitive data type (\textit{e.g.} floats or bytes) in and out of the Application. A reference implementation of this block is provided in OpenCPI's fork of GNU Radio Companion.\\

This fork of GNU Radio Companion also allows for Application and HDL Assembly building, as well as deployment independent of the AV GUI. Some of this capability was presented at the GNU Radio Conference GRCon17; the video is available on \href{https://www.youtube.com/watch?v=CriLitW5vtM}{YouTube}.

\subsection{AD9361 Support}
\label{sec:13_ad9361}
The popular Analog Devices, Inc's AD9361 RF transceiver IC is now supported via a series of Device Workers. The modularity of these workers eases AD9361 transceiver integration with future FPGA systems. Most of the major AD9361 features are supported, including RX/TX RF digitization/data streaming and RF tuning/gain control. The AD9361 Device Workers currently only fully support some operating modes, but contain infrastructure in anticipation of future expansion. These device workers utilize the vendor's \href{https://github.com/analogdevicesinc/no-os}{No-OS software library} for high-level control.\\

There is also ``card'' support for the FMCOMMS2 and FMCOMMS3 evaluation/prototyping RF transceiver FMC cards centered on the AD9361. The newly released \code{ocpi.assets} Project includes a single-channel RX narrowband I/Q stream to file (\path{applications/rx_app}) and single-channel RX/TX FSK modem (\path{applications/FSK}) reference applications, which each support the FMCOMMS2 and FMCOMMS3 card on the zed platform.

\subsection{GUI Improvements}
Since 1.2, the GUI has multiple improvements, some of which are:

\begin{itemize}
\item \textbf{The ability to build OpenCPI Assets} - The Component and Application developer can now build without the command line. The build tool allows RCC and HDL compilation from numerous levels in a Project from individual assets to the entire Project. The tool also allows the developer to build and run Component unit tests while allowing multiple concurrent builds in separated tabbed consoles.

\item \textbf{New Perspective} - This Eclipse Perspective is the new presentation of the build tool. It consists of a number of views where three are specific to OpenCPI.

\item \textbf{Project Explorer view} - This view allows simple navigation to select items to build and provides a way forward to provide OpenCPI features without having to explore the file system.

\item \textbf{OpenCPI Operations Panel} - Selections can be placed in this panel and built for all available RCC and HDL Targets and/or Platforms.

\item \textbf{Build Status View} - Provides a simple graphical presentation of the launched build or test run and its status (\textit{e.g.} running). The user may also re-run build, clean, or run executions from this view and bring the build console window forward.

\item \textbf{New HDL Platform Editor} - The HDL developer can now create and view HDL platform XML in a graphical presentation.
\end{itemize}

\subsection{Project Registry} % AV-3028
\label{sec:13_proj_registry}
Release 1.3 introduces a new concept of ``Project Registry'' to organize and interrelate a set of Projects which allows Projects to be moved (cf.  \ref{sec:13_proj_moved}) as well as present an explicit relationship between them, \textit{e.g.} ``\textit{this} copy of \code{ocpi.assets} was built based upon \textit{that} copy of \code{ocpi.core}.'' Registry manipulation is performed using \ocpidev (cf. \ref{sec:13_ocpidev}).\\

The default configuration is that every Project on a machine shares a single Registry (located at \path{/opt/opencpi/project-registry}). A user must be in the Unix group ``\code{opencpi}'' to manage this global Registry.\\

This new capability deprecates the previously-used \code{OCPI\_PROJECT\_PATH} build-time variable as well as the scripts \path{freeze_project.sh} and \path{thaw_project.sh} noted in \ref{bug:3031}.

\subsection{Project Migration} % AV-3031
\label{sec:13_proj_moved}
With the new Project Registry (cf. \ref{sec:13_proj_registry}), Projects can now be moved to new locations or archived and then restored on another machine with the use of the \code{ocpidev unregister} and \code{ocpidev register} commands. This mitigates the previously-documented deficiency found in \ref{bug:3031}.

\subsection{\ocpidev Improvements} % AV-2583
\label{sec:13_ocpidev}
The ``\ocpidev'' command has been improved in various ways, including:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \code{bash} completion for many commands (try \code{ocpidev <tab><tab>})
\item Ability to show possible HDL platforms: \code{ocpidev show hdl platforms --table}
\item Ability to show possible RCC platforms: \code{ocpidev show rcc platforms}
\item Ability to build unit tests
\item Project Registry (\ref{sec:13_proj_registry}) manipulations
\end{itemize}

\subsection{RCC Platforms}
\label{sec:13_rcc_platforms}
With the new Project Registry (cf. \ref{sec:13_proj_registry}), RCC Platforms can now be defined exclusively within a Project outside of the CDK / Core Project. An example of this can be seen in the \code{inactive} project under \path{rcc/platforms/macos10_13}. This improvement allows BSPs to be self-contained within a Project.

\subsection{Remote Containers (Technology Preview)}
The full-OSS OpenCPI code base has imported previously-written code that allows Remote Containers.

\subsection{OpenCL Containers (Technology Preview)}
The full-OSS OpenCPI code base has imported previously-written code that allows OpenCL (``OCL model'') Containers on CPUs and GPUs.

\section{Changes and Notes}
This section describes items that may cause users of previous versions to modify their code, build system, etc.

\subsection{Major Project Restructuring} % AV-3048, AV-3411, AV-3568
\label{sec:13_restructure}
Starting with Release 1.3, the CDK is no longer a top-level Project. All Components that were previously found in the CDK, \textit{e.g.} \code{file\_read}, have migrated to \code{ocpi.core}. The previously-documented ``Base Project'' has been removed; it was the RPM-specific manner of separating the CDK from the core components needed to run OpenCPI. The various items (cards, devices, specs, etc) that were previously found in the Base Project have been distributed into one of three new Projects. The previously non-OSS proprietary items have been redistributed within the new Projects as well. The Projects are:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \code{ocpi.core} - Core items for the Framework
\item \code{ocpi.assets} - Items fully-supported by the OpenCPI Team
\item \code{ocpi.inactive} - ``Everything else''
\end{itemize}

These items being moved will cause Application XML to possibly fail, \textit{e.g.} anything calling for the \code{ocpi.file\_read} spec now needs to look for \code{ocpi.core.file\_read}. There is a similar rename of \code{ocpiassets} $\Rightarrow$ \code{ocpi.assets}.\\

There is a provided utility script (\path{/opt/opencpi/cdk/scripts/upgradeApp_v1_3.py}) to assist in this migration. This script will modify the package information for the specs required. There are three ways it can be called:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item If given a single argument (the Application XML file name), it will write the same name with \code{updated\_} prepended.
\item If given a second argument, the modified file will be written to that file name.
\item If the second argument is \code{same}, the original file will be overwritten.
\end{itemize}

This change also removes the \path{/opt/opencpi/base_project_source/new_base_project.sh} script found in earlier releases; its equivalent is now \path{/opt/opencpi/projects/new_project_source}, which uses the same arguments as noted in the \textit{Getting Started Guide}.

\subsection{Upgrade Notes} % AV-3240
% The RPMs are designed to allow direct upgrading to newer versions. However, if previous versions of some of the prerequisite RPMs are \textit{uninstalled}, some empty directories may remain, blocking the installation of the current RPMs.
If you have previous versions of the RPM-based OpenCPI RPMs installed, they must all be manually removed, including the prerequisites. \textbf{There is no automatic upgrade path.} Manually performing ``\code{sudo rm -rf} \path{/opt/opencpi/prerequisities}'' after uninstalling \textbf{all} previous RPMs \textit{may} also be needed.

\subsection{Prerequisite RPMs Built With Newer Language Standards} % AV-2670, AV-2601
All prerequisites are now built with the C++11 or the C98 standard implemented. This will increase interoperability and avoid ambiguous situations, \textit{e.g.} the size of a \code{bool} variable.

\subsection{Legacy Platform Names Continue to be Deprecated} % AV-2983
The legacy suffix ``\code{\_pf}'' for simulator platforms, \textit{e.g.} \code{isim\_pf}, is not supported when running unit tests. Unit tests were introduced after the suffix was deprecated, so the effect on end users should be minimal.

\subsection{OCPI\_XILINX\_VIVADO\_DIR Variable Changed} % AV-3220
A bug in Release 1.2 required the variable to be set ``deep'', \textit{e.g.} \path{/data/Xilinx/Vivado/2017.1}. You \textit{must} now set it to the top-level value, \textit{e.g.} \code{/data/Xilinx}. If a specific version of Vivado is required, \code{OCPI\_XILINX\_VIVADO\_VERSION} should be set, \textit{e.g.} \code{2017.01}. As a reminder, these variables only apply if you have both ISE and Vivado installed in different base directories, \textit{e.g.} ISE in \path{/opt/Xilinx} vs. Vivado in \path{/data/Xilinx}.

\subsection{\ocpidev and Requesting RCC Platform To Match HDL Platform} % AV-3457
When building Projects with \ocpidev, the user can tell the build system to automatically select the proper RCC Platform when given an HDL Platform. This option is \code{--rcc-hdl-platform} with a mnemonic of ``build \textit{this} RCC Platform for \textit{that} HDL Platform.'' Previous Releases had the flags backwards (``\code{--build-hdl-rcc-platform}''). This is incorrect and has been deprecated.

\subsection{zero\_padding Component in \texttt{ocpi.assets} deprecated}
In the FSK reference application, \path{zero_padding.hdl} was replaced by two new Workers, \path{zero_pad.hdl} and \path{mfsk_mapper.hdl}. The change was made because \path{zero_padding.hdl} performed two functions: binary FSK mapping and inserting zeros between symbols. Whenever possible, functions should be separated into their own Components for increased flexibility and reuse. The \path{zero_padding} Component will be removed in Release 2.0.

\section{Major Known Deficiencies}
\label{sec:13_bugs}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 1.3:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{1385}
\item \bugref{1392}
\item \bugref{1585}
\item \bugref{2241}
\item \bugref{2400}
\item \bugref{2477}
\item \bugref{3193}
\end{itemize}

The following previously-documented deficiencies have been fixed in this release:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{1645}
\item \bugref{3031}
\item \bugref{3099}
\item \bugref{3107}
\item \bugref{3109}
\end{itemize}

The following previously-documented deficiencies will \textit{not} be fixed:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{3170}: It was determined that this is not a bug. For primitive cores, if a user sets the \code{SourceFiles} variable, they must explicitly list all files, including \path{*_pkg.vhd} files. This is true for \textit{all} platforms.
\end{itemize}

% === End of 1.3

\newpage
\origsection{Release 1.2}
\def\ocpiversion{v1.2.0}  % Need to redefine so doc links are correct
\section{Enhancements}
\subsection{Vivado Support for Applicable Xilinx-Based Platforms} % AV-78, AV-2897, AV-3126
\label{sec:12_vivado}
By far the \#1 requested feature by OpenCPI users, the Framework now supports the use of Xilinx's Vivado on the appropriate Platforms. \textbf{This toolchain is now the default} where applicable (mostly Zynq-based), and it is highly recommended that users of Xilinx-based platforms review the provided \textit{Vivado Usage Guide}.\\

End users should be aware (see \textit{Vivado Usage Guide} for more details) that:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item If you simulate with ModelSim, you may need to upgrade. Vivado requires a minimum version of 10.5c. Testing has been done using 10.6a.
\item If your design requires the use of Xilinx CORE Generator IP (\path{coregen}) items, they must be regenerated with Vivado to be \textit{simulated} in XSIM. Your existing \texttt{ngc} files from ISE can continue to be used for \textit{synthesis}, but porting to new \textit{Vivado IP} is recommended.
\item There is a new platform, \path{zed_ise}, that is intended for testing purposes, but released with the distribution. This platform is the ZedBoard using the Xilinx ISE tool chain.
\end{itemize}

\subsection{New command option ``\code{ocpidev build}''} % AV-2584
To help improve the end-user experience, OpenCPI 1.2 requires less command-line usage of ``\texttt{make}''. The previously-available tool \ocpidev now has a ``\texttt{build}'' verb available. More information can be found in the (OSS) \textit{Component} and \textit{Application Development Guides}.

\subsection{GUI Now Delivered as RPM} % AV-2642
\label{sec:12_guirpm}
There is now an \path{opencpi-ide} RPM included in the distribution. A separate installation of Eclipse for each end user is no longer required. Once installed, any user can launch with the \path{ocpigui} command.

\subsection{Artifact Version Checking} % AV-2226, AV-2453
While backwards compatibility is a major goal of OpenCPI, binary compatibility across versions is \textit{not} guaranteed. Every artifact should always be rebuilt with the latest framework. To enforce this requirement, the framework will check all artifact metadata at deployment time to verify the version used to build. Version 1.1 inserted the proper metadata, but the comparison is new in 1.2, allowing 1.2 to recognize and reject 1.1 artifacts. Artifacts rejected for no other reason will issue a warning message at all debugging levels. This behavior can be overridden by setting the environment variable \path{OCPI_ALLOW_VERSION_MISMATCH} to ``1''; \textit{this is not recommended}.

\subsection{Miscellaneous Improvements}
A quick list of improvements not documented above include:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item Cross-platform ACI builds using \texttt{ocpidev}-generated applications previously failed % AV-2645
\item Picoflexor T6A Software updated to vendor's Drop 5.5.2 % AV-2549
\item \texttt{ocpiassets} project can now be imported into GUI % AV-2775
\item Proxies can now use string properties\footnote{This is noted here because it is one of the first user reported bugs.} % AV-2649
\end{itemize}

\section{Changes and Notes}
This section describes items that may cause users of previous versions to modify their code, build system, etc.

\subsection{rx-spec and tx-spec Support Property Interdependence} % AV-2679
Certain front-ends have different ranges based other properties, \textit{e.g.} the current sample rate, requiring some properties that were previously ``Initial'' (immutable) to have their restrictions relaxed. \textit{This compatibility break should only affect platform developers,} unless applications were incorrectly caching these values. All interfaces above that level should be unaffected.

\subsection{Vivado Support}
Please see \ref{sec:12_vivado} for modifications that \textit{may} need to be performed.

\section{Major Known Deficiencies}
\subsection{Driver Failing to Allocate Memory on Zynq-Based Platforms} % AV-1645, AV-3040
\label{bug:1645}
In some situations after repeated multi-model (RCC and HDL) application runs on Zynq-based platforms (e.g. ZedBoard), the kernel driver will fail to allocate contiguous memory for DMA data transfers. On x86-based platforms, memory for this use is allocated at boot time before memory fragmentation. Currently, no memory is being allocated at boot time for the Zynq-based platforms. Single ocpirun or ACI application runs from the command line do not present any errors. When running an app in a long loop, such as in the unit test framework, or an application that writes a large amount of data (approx. 1GB) to file, this error \textit{may} occur.

\subsection{HDL Workers Cannot Send SOM Without Valid Data} % AV-3099
\label{bug:3099}
Although the HDL Component documentation claims the Framework's internal protocols support a separate Start-of-Message independent of valid data designations, this sequence causes the Component's output port to ignore any remaining data. This was found late within the 1.2 release cycle and should be addressed with the next release.

\subsection{SDP Cannot Handle More Than One ZLM Per Application Run} % AV-3109
\label{bug:3109}
The SDP transport will not propagate a second ZLM, so at this time the \textit{only} ZLM should be an implied end-of-application transmission. This problem does not exist when communicating between RCC-only Workers. Related to, but independent of \ref{bug:3107}. (See also \ref{sec:101_zlm}.)

\subsection{File\_Read and File\_Write Cannot Handle ZLM Mid-file} % AV-3107
\label{bug:3107}
\path{file_read} (HDL implementation) and \path{file_write} (RCC and HDL implementations) will stop if a Zero-Length-Message (ZLM) is found when operating in ``message mode'' regardless of the location within the file. Related to, but independent of \ref{bug:3109}. (See also \ref{sec:101_zlm}.)

\subsection{PCI-Based Platforms Not Always Detected in Remote Tests} % AV-2477
\label{bug:2477}
Using \path{OCPI_REMOTE_TEST_SYSTEMS}, JTAG connection problems have been observed, possibly related to system reboots. They seem to be resolved after disconnecting and reconnecting the USB cable.

\subsection{Built Projects Cannot Be Moved} % AV-3031
\label{bug:3031}
When a Project is built, the dependencies of each artifact and other support files are captured. Some of these contain absolute paths pointing to where the Project is currently located. The distribution includes a pair of \textit{unsupported} scripts that \textit{may} allow movement of Projects. They can be found in \path{/opt/opencpi/cdk/scripts/} and are named \path{freeze_project.sh} and \path{thaw_project.sh}.

\subsection{Properties Before Raw Properties Cannot Have Parameterized Lengths} % AV-2241
\label{bug:2241}
``Raw properties'' start at a certain property with the properties before that being ``non-raw'' properties. Currently, none of these ``before'' properties can have their length be set by an expression dependent on another parameter property.

\subsection{XML Parser Mixed-Case Issue} % AV-1385
\label{bug:1385}
The XML parser does not always recognize tags if differently-cased versions of the same tag are in the same XML file, \textit{e.g.} an OAS having both \texttt{<Instance .../>} and \texttt{<instance .../>} XML tags will fail. Users of the GUI should not be affected.

\subsection{Simulation of Primitive Cores Needs \texttt{Makefile} Modified} % AV-3170
\label{bug:3170}
When designing a Primitive vendor-specific core that is intended for simulation, the required \path{*_pkg} file containing the core's stub must be explicitly listed first in the \path{Makefile}'s \texttt{SourceFiles} variable.

\subsection{Lime RX/TX Proxy Tests on CentOS6} % AV-3193
\label{bug:3193}
The proxy tests for the Lime transceiver use a feature of C++11 that is not supported by the compiler in CentOS 6. The workaround is to use similar code to the following in the various places \verb+to_string()+ was used:
\begin{lstlisting}[language=diff]
-      std::string ClkInStr;
-      ClkInStr = to_string(2 * sample_rate * 1e6).c_str();
+      std::ostringstream ostr_clkin;
+      ostr_clkin << (2 * sample_rate * 1e6);
+      std::string ClkInStr(ostr_clkin.str());
\end{lstlisting}

\subsection{Previously Documented Deficiencies}
The following deficiencies are still present in 1.2:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item \bugref{693}
\item \bugref{1035}
\item \bugref{2400}
\item \bugref{1392}
\item \bugref{1585}
\end{itemize}

\section{Addenda to Previous Release Notes}
% Keep these in order of section
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item The default \texttt{CWD\_MAX\_LENGTH} noted in \ref{sec:11_cwd} is now set to 256. % AV-3119
\item The Liquid RPMs referenced in \ref{sec:11_prereq} are now \textbf{required} to build the \texttt{ocpiassets} project (\path{complex_mixer.rcc}). They are still considered optional when installing.
\end{itemize}

% === End of 1.2

\newpage
\origsection{Release 1.1}
\def\ocpiversion{v1.1.0}  % Need to redefine so doc links are correct
\section{Enhancements}
A quick list of improvements include:
\begin{itemize}
\setlength\itemsep{0em} %tighten
\item Simulatable Data Plane: Allows HW and SW co-simulation to test
integration between heterogeneous Workers
\item Scalable Data Plane: Allows Platform Workers to more efficiently use wider data paths on future platforms, e.g. a 128-bit bus instead of 32-bit\footnote{Currently limited to some Zynq-based platforms.}
\item New automatic test harness creation, including limited remote platform support\footnote{Most \texttt{ocpiassets} have been moved to the new test system to provide examples.}
\item Automatic bus width adaption between HDL Workers
\item Additional Assets components to help design and debug Applications
\item HDL Simulator on-the-fly launching\footnote{See Section~\ref{sec:11_simulators} for more information.}
\item Extended GUI capabilities
\item Official CentOS~7 driver support
\item Split platform names more explicitly between hardware and software platform types
\item Many fields in XML that require numerical values can now have mathematical calculations % AV-1641
\item Added platform support (Picoflexor RCC-Only)
\end{itemize}

\subsection{Debug Symbols for Framework Now Available}
% AV-2101
An RPM containing most debug symbols for the Framework (\code{opencpi-debuginfo-*.x86\_64.rpm}) is now provided. This greatly enhances the debugging of RCC Workers using industry-standard debuggers such as \texttt{gdb} and \texttt{ddd}.

\subsection{Kernel Driver Memory Arguments}
In previous versions, the ``\texttt{memmap}'' argument was given to the Linux kernel command line. This can conflict with other software that may also require reserved memory. If the user requires the reservation of more than one memory area using the \texttt{memmap} option, the OpenCPI driver will:
\begin{itemize}
\setlength\itemsep{0pt} %tighten
\item Assume the first \texttt{memmap} is for its use
\item Explicitly use the range/subrange marked with an additional \texttt{opencpi\_memmap}. \textit{The original \texttt{memmap} must still be provided} for the kernel to make the reservation.
\end{itemize}
% AV-268
See \path{/opt/opencpi/driver/README} for more information, including usage examples and configuration.

\subsection{HDL File\_Read and File\_Write CWD}
\label{sec:11_cwd}
% AV-977
The HDL Workers implementing the \texttt{File\_Read} and \texttt{File\_Write} specs distributed in 1.0 failed if used in a directory that exceeded 100 characters deep. There is an additional parameter \texttt{CWD\_MAX\_LENGTH} on these Workers that can be increased to allow deeper directories when needed.

\section{Changes and Notes}
This section describes items that may cause users of previous versions to modify their code, build system, etc.

\subsection{Simulators Renamed and Work Out-of-the-Box}
\label{sec:11_simulators}
% AV-1889, AV-2279
The simulator platform names have been renamed to remove the ``\_pf'' suffix, \textit{e.g.} \texttt{isim}. The \texttt{isim}\footnote{Only version 14.7 without rebuilding the Base Project.} and \texttt{modelsim} simulation platforms can now be targeted once the appropriate environment variables are set, \textit{e.g.} \texttt{OCPI\_MODELSIM\_DIR}. With \texttt{ocpirun} able to launch simulations, the usage of ``\texttt{ocpihdl simulate}'' is now deprecated and does nothing.\\
~\\
\begin{minipage}{\linewidth}
An example:
\begin{verbatim}
$ ocpirun -C
Available containers:
 #  Model Platform       OS     OS-Version  Arch     Name
 0  hdl   isim                                       lsim:isim
 1  hdl   modelsim                                   lsim:modelsim
 2  rcc   centos7        linux  c7          x86_64   rcc0
\end{verbatim}
\end{minipage}

\subsection{HDL Width Adapters Not Required}
% AV-1230 et al
One of the advantages of the new \textit{Scalable Data Plane} is the Framework's automatic insertion of ``width adapters'' whenever needed between Workers in an Assembly. This means the user can remove any \path{wsi_16_to_32}, \path{wsi_32_to_16}, or \path{wsi_width_adapter} Components that are instantiated in their Assemblies or Applications. It is harmless to leave them in existing designs, but future Applications should not instantiate them.

\subsection{Platform Name Changes}
% AV-2270
\label{sec:11_platform_names}
To allow for more hardware and software separation in the future, there is now more distinction used in platform naming. Previously, the keyword ``zed'' was used to describe both software (the Xilinx-based Linux kernel) and hardware (the ZedBoard). This ambiguity led to confusion for some users and implied a nonexistent reliance on the ZedBoard. Starting with OpenCPI 1.1, the software platform for most Zynq-based hardware is labeled ``\verb+xilinx13_3+'', analogous to ``\verb+centos7+''. The ``13\_3'' is shorthand for Xilinx's Linux release from the Third Quarter (Q3) of 2013. This means that previous code that used an \texttt{OCPI\_TARGET\_PLATFORM} of \texttt{zed} must now be changed to \texttt{xilinx13\_3}.

\subsection{RCC Cross-compilation No Longer Uses \texttt{OCPI\_CROSS\_HOST}}
% AV-816, AV-1998, AV-2143
Previous OpenCPI releases used \texttt{OCPI\_CROSS\_HOST} to define RCC cross-compilation. This required the usage of less-than-memorable values such as \texttt{arm-xilinx-linux-gnueabi}. The new manner is to use \texttt{OCPI\_TARGET\_PLATFORM}, \texttt{RccPlatforms}, or \texttt{RccHdlPlatforms}, which allow more intuitive and consistent values (See Section~\ref{sec:11_platform_names}). For example, the example above could be replaced with ``\texttt{OCPI\_TARGET\_PLATFORM=xilinx13\_3}'', ``\texttt{RccPlatforms=xilinx13\_3}'', or ``\texttt{RccHdlPlatforms=zed}''.\\

The \texttt{RccPlatforms} and \texttt{RccHdlPlatforms} variables allow the targeting of multiple platforms with a single \verb+make+ call.
% AV-2363
While either format can be used for Workers, ACI Applications can only be built for a single target platform using the \texttt{OCPI\_TARGET\_PLATFORM} variable.

\subsection{Updating a 1.0.x Unit Test for the 1.1 Framework}
% AV-1869
Some unit tests for Components were released with the 1.0.x version of \texttt{ocpiassets} that relied upon simulator availability or certain platform names reported by \texttt{ocpirun} (see Sections~\ref{sec:11_simulators} and \ref{sec:11_platform_names}). If any users have developed their own unit tests based on these, some updates may be required for them to work using the new release.\\

\begin{minipage}{\linewidth}
All of the provided unit tests have been updated to work with the new release and can be used for reference. If the previous unit test is using \texttt{ocpirun}, the \texttt{Makefile} needs to be updated to add the following to any lines that are forming the execution string:\\

\forceindent\code{-P \$@=\$P}\\

This is forcing the platform of your unit test to be set explicitly with \texttt{ocpirun}'s \texttt{-P} option. \\
\end{minipage}

If the unit test is using an ACI Application to run the unit test, the platform needs to be set similarly within the C++ source. The Platform will be passed from the \texttt{Makefile} to the ACI Application as a command-line argument by adding \code{\$P} to the end of any execution strings. The source code needs to be updated to use this new argument by adding the following to the C++ application, while changing ``\texttt{XXX}'' to your Worker's name and ``\texttt{2}'' to the correct argument number based on your current inputs:\\
\begin{minipage}{\linewidth}
\lstset{language=C++,
  basicstyle=\color{Blue}\ttfamily, % Blue (real blue) not blue (AV header blue)
  stringstyle=\color{Green},
}
\begin{lstlisting}[language=c++]
  std::string pf("XXX=");
  pf += argv[2];
  OA::PValue params[] = {
  ...
  OA::PVString("platform", pf.c_str()),
  ...
  OA::PVEnd};
  ...
  OA::Application app(appNameXml, params);
\end{lstlisting}
\end{minipage}
~\\
This patch is adding the platform that is passed in (via \texttt{argv[2]}) to the \texttt{params} array that is used to constrain the application's search space.\\

The user could do a full conversion to the new testing framework released with 1.1, but this is expected to be more work.

\subsection{Prerequisite RPM Changes}
\label{sec:11_prereq}
% AV-1117
The Open Source \href{http://tukaani.org/xz/}{XZ Utils} has replaced the LZMA Utils. This has caused the provided RPM to change names. Additionally, new RPMs are now provided for other prerequisite packages; consult the \textit{Installation Guide} for a list. An upgrade to the new RPMs \textit{should} cause previous versions to be removed, but the recommended procedure is to uninstall all 1.0.x RPMs before installing 1.1.\\

% AV-1788
For the first time, OpenCPI is providing a pre-packaged third-party library that is not directly required by the Framework: \href{http://liquidsdr.org/}{liquid-dsp}. This is provided to assist end users in the creation of DSP-heavy RCC Workers that execute on all currently-supported platforms without requiring any additional configuration for cross-compilation. It is treated like any other prerequisite library; usage information can be found in the \textit{OpenCPI RCC Development Guide}.

\subsection{Deprecated RCC controlOperations}
% AV-1711, AV-1674
The RCC \texttt{controlOperations} \texttt{afterConfigure} and \texttt{beforeQuery} have been deprecated and removed from the IDE. They were never called by the Framework and the C++ interface provides the finer-granularity \texttt{XXX\_read()} and \texttt{XXX\_written()} notification methods.

\subsection{64-Bit Build Host Issues (``Value too large for defined data type'')}
% AV-1838
Some 32-bit cross-compilers exhibit somewhat-rare problems on 64-bit host machines using file systems that allow 64-bit inodes, \textit{e.g.} XFS. A new RPM, \path{ocpi-rereq-build_support-inode64}, provides a workaround. Additional information can be found in the Picoflexor T6A documentation.

\section{Major Known Deficiencies}
This is a list of major known deficiencies at the release of 1.1 that were not previously documented in Section~\ref{sec:101}. This is \textit{not} an exhaustive list.

\subsection{Maximum Message Length in PCI-Based Platforms}
% AV-1392, AV-2105
\label{bug:1392}
PCI-based platforms, \textit{e.g.} ML605 and ALST4, are limited to a 32KB buffer. By default, that buffer is split into two, resulting in two 16KB buffers. The maximum message length, in bytes, is then 16KB-16\footnote{16 bytes required for metadata}. RCC Workers will see any data beyond the limit as zero-filled.

\subsection{MAC Address on ZedBoard when Using the xilinx13\_3 Software Platform (use xilinx13\_4 to avoid the issue)}
% AV-2400, AV-2403
\label{bug:2400}
The currently used Linux release (``\texttt{xilinx13\_3}'') cannot properly set the MAC address on the ZedBoard. This should only affect users who have \textit{more than one ZedBoard} on a single network. Consult the \textit{ZedBoard Getting Started Guide} for a workaround.

\subsection{Platform Development Guide}
% AV-1585
\label{bug:1585}
While all documentation is constantly under improvement, the \textit{Platform Development Guide} in particular is currently undergoing major changes, in part due to the SDP improvements. If an end user intends to create a Board Support Package (BSP) for a new target platform, they should contact the OpenCPI Team to ensure the latest Guide is used.

% === End of 1.1

\newpage
\origsection{Release 1.0.1}
\def\ocpiversion{v1.0.0}  % Need to redefine so doc links are correct
\label{sec:101}
These are ``Release Notes'' from Version 1.0.1 that are still relevant as of Version 1.1.
\section{OpenCPI HDL Assembly Filename Constraint}
\label{bug:1035}
% AV-1035
Due to a limitation with the ISE Simulator (isim), the filename of any HDL Assembly must be all lowercase letters. A capital letter anywhere in the filename will result in an error.

\section{32-bit Architecture File Size Limit}
\label{bug:693}
% AV-693
On some software platforms, there will be an error when writing files greater than 2\textsuperscript{31} bytes (about 2.2 GB), especially if using NFS. This includes the ARM 32-bit architecture on Zynq-based platforms.

\section{Eclipse Project Description File}
A necessary file known as the project description file (\verb+.project+) is generated when creating a Project in the AV GUI. This file is required by Eclipse and is used to describe the project in its workspace. Removal of this file will cause an error.

\section{Refreshing the AV GUI}
Whenever files are being created or removed via command-line for an Project, the Project within the IDE needs to be refreshed. Examples include executing \verb+make clean+, \verb+make tests+, \verb+make rcc+, etc. Many of the \verb+make+ commands will create or remove files in the Project, so it is important to refresh the Project within the IDE to reflect the changes.

\section{Non-default Xilinx Installation Locations}
OpenCPI assumes Xilinx's installation location is \verb+/opt/+. If the Xilinx tools were installed in another location, the cross compiling environment variable can not be inferred correctly. To resolve this issue, refer to the \path{/opt/opencpi/cdk/env/xilinx.sh.example} file and the \textit{Installation Guide}.

\section{Zero-Length Message Finite State Machines}
\label{sec:101_zlm}
Some workers make use of a finite state machine to monitor a zero-length message (\textit{ZLM}) from an upstream worker. This implementation was designed specifically with unit tests in mind so that simulations could be ended with an end-of-file (EOF) condition from the File Read Worker rather than waiting for a fixed amount of time. Simulation times vary across machines and Workers, so predicting how much time a Worker might need on various machines is not deterministic. In the future, the handling of zero-length message may change, but the current finite state machines for handling them are provided to complete the unit tests of the workers.
\end{appendices}
\end{document}
