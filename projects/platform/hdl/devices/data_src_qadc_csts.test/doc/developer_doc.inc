%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% this file was generated by docGen.py
% this file is intended to be edited
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
\textit{\textbf{Revision History}}
  \begin{table}[H]
  \label{table:revisions} % Add "[H]" to force placement of table
    \begin{longtable}{|p{\dimexpr0.15\textwidth-2\tabcolsep\relax}
                      |p{\dimexpr0.75\textwidth-2\tabcolsep\relax}
                      |p{\dimexpr0.1\textwidth-2\tabcolsep\relax}|}
    \hline
    \rowcolor{blue}
    \textbf{Revision} & \textbf{Description of Change} & \textbf{Date} \\
      \hline
      v1.6 & Released initial technology preview & 02/2020 \\
      \hline
      v1.7 & Updated port/property/interface tables for accuracy. Package ID changed from ocpi.assets to ocpi.platform. & 06/2020 \\
      \hline
      v2.1 & Updated Worker Implementation Details section to talk about new properties. Updated Source Dependencies section for correct location of dependencies. & 03/2021 \\
      \hline
    \end{longtable}
  \end{table}
\end{center}
\newpage

\def\name{\comp}
\def\workertype{Device}
\def\version{\ocpiversion}
\def\releasedate{06/2020}
\def\componentlibrary{ocpi.platform.devices}
\def\workers{data\_{}src\_{}adc.hdl}
\def\testedplatforms{xsim (Vivado 2017.1)}
\input{\snippetpath/component_summary_table}

\section*{Functionality}
The \comp \ component provides the property and port definitions necessary for the data\_src\_adc.hdl worker which performs all the generic functionality required to ingest Analog-to-Digital Converter (ADC) data onto an FPGA.

\section*{Worker Implementation Details}
The following section describes the data\_src\_adc.hdl worker. Sampled data from an ADC is sent to the worker via the \verb+dev+ devsignal port. The samples are sign-extended and justified to a 16-bit I, 16-bit Q values, which is the standard provided by the samples argument of the ComplexShortWithMetadata-prot protocol used by the \verb+out+ port. Justification within the 16-bit values is performed according to the \verb+ADC_INPUT_IS_LSB_OF_OUT_PORT+ parameter property. The ADC samples are sent along with the ADC clock on the \verb+dev+ devsignal port. The ouput port clock is driven by the ADC clock, and backpressure from the output port's ready signal is not expected under normal operation. When backpressure is experienced, the \verb+overrun_sticky_error+ property is set to true, an \verb+\verb+out+ port samples message will be ended if one is in progress, and a sync message will be sent to the output port. There is also the \verb+samp_count_before_first_samp_drop+ property that gives the number of samples before the first dropped sample and 
the \verb+num_dropped_samps+ property that gives number of samples dropped. These properties should be checked at the end of an app run because they won't be stable until then. The worker doesn't use cdc crossing circuits for \verb+samp_count_before_first_samp_drop+ and \verb+num_dropped_samps+ because it takes advantage that \verb+samp_count_before_first_samp_drop+ and \verb+num_dropped_samps+ will have a stable value by the time the control plane reads those values at the end of an app run. \\

Finally there is are the \verb+send_eof+ and \verb+num_samples_before_eof+ properties which allow one to send an eof after \verb+num_samples_before_eof+ samples have been sent.

%\section*{Block Diagrams}
%\subsection*{Top level}
\begin{center}
\end{center}\pagebreak

\section*{Source Dependencies}
\subsection*{\comp.hdl}
\begin{itemize}
	\item platform/hdl/devices/\comp.hdl/\comp.vhd
	\item core/hdl/primitives/cdc/cdc\_pkg.vhd
	\item core/hdl/primitives/cdc/fast\_pulse\_to\_slow\_sticky.vhd
	\item core/hdl/primitives/protocol/complex\_short\_with\_metadata\_pkg.vhd
	\item core/hdl/primitives/protocol/out\_port\_cswm\_samples\_and\_sync.vhd
	\item core/hdl/primitives/util/util\_pkg.vhd
	\item core/hdl/primitives/util/in2out.v
	\item core/hdl/primitives/util/reset\_detector.vhd
	\item platform/hdl/primitives/adc/adc\_pkg.vhd
	\item platform/hdl/primitives/adc/samp\_drop\_detector.vhd
	\item platform/hdl/primitives/adc/data\_widener.vhd
\end{itemize}

\begin{landscape}
  \input{component_spec_properties.inc} % it is recommended to NOT remove this line

  \input{worker_properties.inc} % it is recommended to NOT remove this line

  \input{component_ports.inc} % it is recommended to NOT remove this line

  \input{worker_interfaces.inc} % it is recommended to NOT remove this line
\end{landscape}

%\section*{Control Timing and Signals}
%\subsection*{\comp.hdl}
%\begin{flushleft}
%\end{flushleft}

%\section*{Performance and Resource Utilization}
%\subsubsection*{\comp.rcc}
%\subsubsection*{\comp.hdl}

\section*{Test and Verification}
\begin{flushleft}
For verification, the OpenCPI unit test framework utilizes an emulator worker. The emulator worker produces a 30.72 MHz clock which is forwarded to the \textbf{dev} port of the UUT. The unit test checks that the input file and output file match.
\end{flushleft}
